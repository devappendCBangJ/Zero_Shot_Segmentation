"""
This interface provides access to four datasets:
1) refclef
2) refcoco
3) refcoco+
4) refcocog
split by unc and google

The following API functions are defined:
REFER      - REFER api class
getRefIds  - get ref ids that satisfy given filter conditions.
getAnnIds  - get ann ids that satisfy given filter conditions.
getImgIds  - get image ids that satisfy given filter conditions.
getCatIds  - get category ids that satisfy given filter conditions.
loadRefs   - load refs with the specified ref ids.
loadAnns   - load anns with the specified ann ids.
loadImgs   - load images with the specified image ids.
loadCats   - load category names with the specified category ids.
getRefBox  - get ref's bounding box [x, y, w, h] given the ref_id
showRef    - show image, segmentation or box of the referred object with the ref
getMask    - get mask and area of the referred object given ref
showMask   - show mask of the referred object given ref
"""

import sys
import os.path as osp
import json
import pickle as pickle
import time
import itertools
import skimage.io as io
import matplotlib.pyplot as plt
from matplotlib.collections import PatchCollection
from matplotlib.patches import Polygon, Rectangle
from pprint import pprint
import numpy as np 
from pycocotools import mask


class REFER:

    def __init__(self, data_root, dataset='refcoco', splitBy='unc'):
        # provide data_root folder which contains refclef, refcoco, refcoco+ and refcocog
        # also provide dataset name and splitBy information
        # e.g., dataset = 'refcoco', splitBy = 'unc'
        print('loading dataset %s into memory...' % dataset)
        if dataset == 'refcocog':
            print('Split by {}!'.format(splitBy))
        self.ROOT_DIR = osp.abspath(osp.dirname(__file__))
        self.DATA_DIR = osp.join(data_root, dataset)
        if dataset in ['refcoco', 'refcoco+', 'refcocog']:
            self.IMAGE_DIR = osp.join('/media/hi/SK Gold P31/Capstone/COCO/train2014') # 변경!!! # default : self.IMAGE_DIR = osp.join(data_root, 'images/mscoco/images/train2014')
        elif dataset == 'refclef':
            self.IMAGE_DIR = osp.join(data_root, 'images/saiapr_tc-12')
        else:
            print('No refer dataset is called [%s]' % dataset)
            sys.exit()

        # load refs from data/dataset/refs(dataset).json
        tic = time.time() # check
        ref_file = osp.join(self.DATA_DIR, 'refs(' + splitBy + ').p') #
        self.data = {}
        self.data['dataset'] = dataset # 'images/mscoco/images/train2014
        f = open(ref_file, 'r')
        self.data['refs'] = pickle.load(open(ref_file, 'rb'))
        # load annotations from data/dataset/instances.json
        instances_file = osp.join(self.DATA_DIR, 'instances.json') # 변경!!!
        instances = json.load(open(instances_file, 'r'))
        self.data['images'] = instances['images'] # len(19994), image id
        self.data['annotations'] = instances['annotations'] # len(196771), image id
        self.data['categories'] = instances['categories'] # len(80)

        # create index
        self.createIndex() # mapping 해주는 애 인가?
        print('DONE (t=%.2fs)' % (time.time() - tic))

    def createIndex(self):
        # create sets of mapping
        # 1)  Refs: 	 	{ref_id: ref}
        # 2)  Anns: 	 	{ann_id: ann}
        # 3)  Imgs:		 	{image_id: image}
        # 4)  Cats: 	 	{category_id: category_name}
        # 5)  Sents:     	{sent_id: sent}
        # 6)  imgToRefs: 	{image_id: refs}
        # 7)  imgToAnns: 	{image_id: anns}
        # 8)  refToAnn:  	{ref_id: ann}
        # 9)  annToRef:  	{ann_id: ref}
        # 10) catToRefs: 	{category_id: refs}
        # 11) sentToRef: 	{sent_id: ref}
        # 12) sentToTokens: {sent_id: tokens}
        print('creating index...')

        # fetch info from instances
        Anns, Imgs, Cats, imgToAnns = {}, {}, {}, {}
        for ann in self.data['annotations']: # instances.json 에서 정보를 가져옴
            Anns[ann['id']] = ann # ann id를 기반으로 ann을 검색할 수 있게 전처리 해주는거 같음?
            imgToAnns[ann['image_id']] = imgToAnns.get(ann['image_id'], []) + [ann] # image_id = 98304 이고 여기에 ann을 추가함. 여러 Ann이 존재하는데 매핑시켜주기 위함인듯?
        for img in self.data['images']:
            Imgs[img['id']] = img # image id 마다 img 정보를 담는다.
        for cat in self.data['categories']:
            Cats[cat['id']] = cat['name']

        # fetch info from refs
        Refs, imgToRefs, refToAnn, annToRef, catToRefs = {}, {}, {}, {}, {}
        Sents, sentToRef, sentToTokens = {}, {}, {}
        for ref in self.data['refs']:
            # ids
            ref_id = ref['ref_id']
            ann_id = ref['ann_id']
            category_id = ref['category_id']
            image_id = ref['image_id']

            # add mapping related to ref
            Refs[ref_id] = ref
            imgToRefs[image_id] = imgToRefs.get(image_id, []) + [ref]
            catToRefs[category_id] = catToRefs.get(category_id, []) + [ref]
            refToAnn[ref_id] = Anns[ann_id]
            annToRef[ann_id] = ref

            # add mapping of sent
            for sent in ref['sentences']:
                Sents[sent['sent_id']] = sent
                sentToRef[sent['sent_id']] = ref
                sentToTokens[sent['sent_id']] = sent['tokens']

        # create class members
        self.Refs = Refs
        self.Anns = Anns
        self.Imgs = Imgs
        self.Cats = Cats
        self.Sents = Sents
        self.imgToRefs = imgToRefs
        self.imgToAnns = imgToAnns
        self.refToAnn = refToAnn
        self.annToRef = annToRef
        self.catToRefs = catToRefs
        self.sentToRef = sentToRef
        self.sentToTokens = sentToTokens
        print('index created.')

    def getRefIds(self, image_ids=[], cat_ids=[], ref_ids=[], split=''):
        image_ids = image_ids if type(image_ids) == list else [image_ids]
        """ image_ids : [] """
        cat_ids = cat_ids if type(cat_ids) == list else [cat_ids]
        """ ref_ids : [] """
        ref_ids = ref_ids if type(ref_ids) == list else [ref_ids]
        """ ref_ids : [] """

        if len(image_ids) == len(cat_ids) == len(ref_ids) == len(split) == 0:
            refs = self.data['refs']
        else:
            if not len(image_ids) == 0:
                refs = [self.imgToRefs[image_id] for image_id in image_ids]
            else:
                refs = self.data['refs']
                """
                refs shape : 50000 -> dict 8
                refs : [{'sent_ids': [0, 1, 2], 'file_name': 'COCO_train2014_000000581857_16.jpg', 'ann_id': 1719310, 'ref_id': 0, 'image_id': 581857, 'split': 'train', 'sentences': [{'tokens': ['the', 'lady', 'with', 'the', 'blue', 'shirt'], 'raw': 'THE LADY WITH THE BLUE SHIRT', 'sent_id': 0, 'sent': 'the lady with the blue shirt'}, {'tokens': ['lady', 'with', 'back', 'to', 'us'], 'raw': 'lady w back to us', 'sent_id': 1, 'sent': 'lady with back to us'}, {'tokens': ['blue', 'shirt'], 'raw': 'blue shirt', 'sent_id': 2, 'sent': 'blue shirt'}], 'category_id': 1}, {'sent_ids': [3, 4, 5], 'file_name': 'COCO_train2014_000000581857_0.jpg', 'ann_id': 463958, 'ref_id': 1, 'image_id': 581857, 'split': 'train', 'sentences': [{'tokens': ['woman', 'in', 'gray', 'shirt', 'facing', 'camera', 'on', 'right'], 'raw': 'woman in gray shirt facing camera on right', 'sent_id': 3, 'sent': 'woman in gray shirt facing camera on right'}, {'tokens': ['woman', 'gray', 'right'], 'raw': 'woman gray right', 'sent_id': 4, 'sent': 'woman gray right'}, {'tokens': ['woman', 'greyshirt', 'right'], 'raw': 'woman greyshirt right', 'sent_id': 5, 'sent': 'woman greyshirt right'}], 'category_id': 1}, {'sent_ids': [6, 7, 8], 'file_name': 'COCO_train2014_000000581839_2.jpg', 'ann_id': 495152, 'ref_id': 2, 'image_id': 581839, 'split': 'train', 'sentences': [{'tokens': ['person', 'standing', 'u'], 'raw': 'person standing u', 'sent_id': 6, 'sent': 'person standing u'}, {'tokens': ['standing'], 'raw': 'standing', 'sent_id': 7, 'sent': 'standing'}, {'tokens': ['middle', 'standing', 'up'], 'raw': 'middle standing up', 'sent_id': 8, 'sent': 'middle standing up'}], 'category_id': 1}, {'sent_ids': [9, 10, 11], 'file_name': 'COCO_train2014_000000581839_1.jpg', 'ann_id': 485695, 'ref_id': 3, 'image_id': 581839, 'split': 'train', 'sentences': [{'tokens': ['lady', 'sitting', 'on', 'right'], 'raw': 'lady sitting on right', 'sent_id': 9, 'sent': 'lady sitting on right'}, {'tokens': ['right', 'girl', 'on', 'floor'], 'raw': 'right girl on floor', 'sent_id': 10, 'sent': 'right girl on floor'}, {'tokens': ['woman', 'sitting', 'on', 'right'], 'raw': 'woman sitting on right', 'sent_id': 11, 'sent': 'woman sitting on right'}], 'category_id': 1}, {'sent_ids': [12, 13, 14], 'file_name': 'COCO_train2014_000000581789_1.jpg', 'ann_id': 453177, 'ref_id': 4, 'image_id': 581789, 'split': 'train', 'sentences': [{'tokens': ['woman'], 'raw': 'woman', 'sent_id': 12, 'sent': 'woman'}, {'tokens': ['left', 'person'], 'raw': 'left person', 'sent_id': 13, 'sent': 'left person'}, {'tokens': ['woman', 'under', 'suitcase'], 'raw': 'woman under suitcase', 'sent_id': 14, 'sent': 'woman under suitcase'}], 'category_id': 1}, {'sent_ids': [15, 16, 17], 'file_name': 'COCO_train2014_000000581789_0.jpg', 'ann_id': 440706, 'ref_id': 5, 'image_id': 581789, 'split': 'train', 'sentences': [{'tokens': ['man', 'in', 'jacket'], 'raw': 'man in jacket', 'sent_id': 15, 'sent': 'man in jacket'}, {'tokens': ['man', 'trying', 'to', 'help', 'with', 'suitcase'], 'raw': 'Man trying to help with suitcase', 'sent_id': 16, 'sent': 'man trying to help with suitcase'}, {'tokens': ['man'], 'raw': 'man', 'sent_id': 17, 'sent': 'man'}], 'category_id': 1}, {'sent_ids': [18, 19, 20], 'file_name': 'COCO_train2014_000000581766_2.jpg', 'ann_id': 1097431, 'ref_id': 6, 'image_id': 581766, 'split': 'train', 'sentences': [{'tokens': ['left', 'most', 'toilet'], 'raw': 'left most toilet', 'sent_id': 18, 'sent': 'left most toilet'}, {'tokens': ['far', 'left', 'toilet'], 'raw': 'far left toilet', 'sent_id': 19, 'sent': 'far left toilet'}, {'tokens': ['left', 'urinal'], 'raw': 'left urinal', 'sent_id': 20, 'sent': 'left urinal'}], 'category_id': 70}, {'sent_ids': [21, 22, 23], 'file_name': 'COCO_train2014_000000581766_0.jpg', 'ann_id': 1093269, 'ref_id': 7, 'image_id': 581766, 'split': 'train', 'sentences': [{'tokens': ['right', 'stall'], 'raw': 'right stall', 'sent_id': 21, 'sent': 'right stall'}, {'tokens': ['right', 'urinal'], 'raw': 'right urinal', 'sent_id': 22, 'sent': 'right urinal'}, {'tokens': ['right', 'urinal'], 'raw': 'right urinal', 'sent_id': 23, 'sent': 'right urinal'}], 'category_id': 70}, {'sent_ids': [24, 25], 'file_name': 'COCO_train2014_000000581739_2.jpg', 'ann_id': 1154905, 'ref_id': 8, 'image_id': 581739, 'split': 'train', 'sentences': [{'tokens': ['right', 'vase'], 'raw': 'RIGHT VASE', 'sent_id': 24, 'sent': 'right vase'}, {'tokens': ['right', 'most', 'vase'], 'raw': 'right most vase', 'sent_id': 25, 'sent': 'right most vase'}], 'category_id': 86}, {'sent_ids': [26, 27, 28], 'file_name': 'COCO_train2014_000000581739_1.jpg', 'ann_id': 1152539, 'ref_id': 9, 'image_id': 581739, 'split': 'train', 'sentences': [{'tokens': ['middle', 'vase'], 'raw': 'middle vase', 'sent_id': 26, 'sent': 'middle vase'}, {'tokens': ['middle'], 'raw': 'middle', 'sent_id': 27, 'sent': 'middle'}, {'tokens': ['center', 'vase'], 'raw': 'CENTER VASE', 'sent_id': 28, 'sent': 'center vase'}], 'category_id': 86}, {'sent_ids': [29, 30], 'file_name': 'COCO_train2014_000000581739_0.jpg', 'ann_id': 1151495, 'ref_id': 10, 'image_id': 581739, 'split': 'train', 'sentences': [{'tokens': ['left', 'vase'], 'raw': 'left vase', 'sent_id': 29, 'sent': 'left vase'}, {'tokens': ['left', 'vase'], 'raw': 'left vase', 'sent_id': 30, 'sent': 'left vase'}], 'category_id': 86}, {'sent_ids': [31, 32, 33], 'file_name': 'COCO_train2014_000000581738_4.jpg', 'ann_id': 247896, 'ref_id': 11, 'image_id': 581738, 'split': 'train', 'sentences': [{'tokens': ['bus', 'on', 'the', 'left'], 'raw': 'bus on the left', 'sent_id': 31, 'sent': 'bus on the left'}, {'tokens': ['left', 'buss'], 'raw': 'left buss', 'sent_id': 32, 'sent': 'left buss'}, {'tokens': ['red', 'bus', 'on', 'the', 'left'], 'raw': 'Red bus on the left', 'sent_id': 33, 'sent': 'red bus on the left'}], 'category_id': 6}, {'sent_ids': [34, 35, 36], 'file_name': 'COCO_train2014_000000581738_1.jpg', 'ann_id': 165092, 'ref_id': 12, 'image_id': 581738, 'split': 'train', 'sentences': [{'tokens': ['bus', 'in', 'front'], 'raw': 'bus in front', 'sent_id': 34, 'sent': 'bus in front'}, {'tokens': ['right', 'bus'], 'raw': 'right bus', 'sent_id': 35, 'sent': 'right bus'}, {'tokens': ['whole', 'bus'], 'raw': 'whole bus', 'sent_id': 36, 'sent': 'whole bus'}], 'category_id': 6}, {'sent_ids': [37, 38, 39], 'file_name': 'COCO_train2014_000000581719_3.jpg', 'ann_id': 2204728, 'ref_id': 13, 'image_id': 581719, 'split': 'train', 'sentences': [{'tokens': ['the', 'head', 'just', 'behind', 'the', 'girl', 'on', 'leftin', 'the', 'middle'], 'raw': 'the head just behind the girl on left...in the middle', 'sent_id': 37, 'sent': 'the head just behind the girl on leftin the middle'}, {'tokens': ['girl', 'with', 'no', 'cap', 'on'], 'raw': 'girl with no cap on', 'sent_id': 38, 'sent': 'girl with no cap on'}, {'tokens': ['brown', 'hair', 'coming', 'out', 'of', 'girls', 'chin'], 'raw': 'brown hair coming out of girls chin', 'sent_id': 39, 'sent': 'brown hair coming out of girls chin'}], 'category_id': 1}, {'sent_ids': [40, 41, 42], 'file_name': 'COCO_train2014_000000581719_1.jpg', 'ann_id': 516523, 'ref_id': 14, 'image_id': 581719, 'split': 'train', 'sentences': [{'tokens': ['left', 'kid'], 'raw': 'left kid', 'sent_id': 40, 'sent': 'left kid'}, {'tokens': ['player', 'left'], 'raw': 'player left', 'sent_id': 41, 'sent': 'player left'}, {'tokens': ['left', 'player', 'front'], 'raw': 'left player front', 'sent_id': 42, 'sent': 'left player front'}], 'category_id': 1}, {'sent_ids': [43, 44, 45], 'file_name': 'COCO_train2014_000000581719_0.jpg', 'ann_id': 511746, 'ref_id': 15, 'image_id': 581719, 'split': 'train', 'sentences': [{'tokens': ['boy'], 'raw': 'Boy', 'sent_id': 43, 'sent': 'boy'}, {'tokens': ['kid', 'looking', 'at', 'you'], 'raw': 'kid looking at you', 'sent_id': 44, 'sent': 'kid looking at you'}, {'tokens': ['boy', 'front'], 'raw': 'boy front', 'sent_id': 45, 'sent': 'boy front'}], 'category_id': 1}, {'sent_ids': [46, 47, 48], 'file_name': 'COCO_train2014_000000581686_1.jpg', 'ann_id': 41223, 'ref_id': 16, 'image_id': 581686, 'split': 'train', 'sentences': [{'tokens': ['bird', 'on', 'right'], 'raw': 'bird on right', 'sent_id': 46, 'sent': 'bird on right'}, {'tokens': ['right', 'bird'], 'raw': 'right bird', 'sent_id': 47, 'sent': 'right bird'}, {'tokens': ['right', 'bird'], 'raw': 'rt bird', 'sent_id': 48, 'sent': 'right bird'}], 'category_id': 16}, {'sent_ids': [49, 50, 51], 'file_name': 'COCO_train2014_000000581686_0.jpg', 'ann_id': 38565, 'ref_id': 17, 'image_id': 581686, 'split': 'train', 'sentences': [{'tokens': ['left', 'bird'], 'raw': 'left bird', 'sent_id': 49, 'sent': 'left bird'}, {'tokens': ['left', 'bird'], 'raw': 'left bird', 'sent_id': 50, 'sent': 'left bird'}, {'tokens': ['bird', 'on', 'left'], 'raw': 'bird on left', 'sent_id': 51, 'sent': 'bird on left'}], 'category_id': 16}, {'sent_ids': [52, 53, 54], 'file_name': 'COCO_train2014_000000581657_7.jpg', 'ann_id': 1103476, 'ref_id': 18, 'image_id': 581657, 'split': 'train', 'sentences': [{'tokens': ['second', 'laptop', 'from', 'front', 'right', 'center'], 'raw': 'second laptop from front right center', 'sent_id': 52, 'sent': 'second laptop from front right center'}, {'tokens': ['laptop', 'second', 'from', 'front'], 'raw': 'laptop 2nd from front', 'sent_id': 53, 'sent': 'laptop second from front'}, {'tokens': ['laptop', 'above', 'cellphone', 'right'], 'raw': 'laptop above cellphone right', 'sent_id': 54, 'sent': 'laptop above cellphone right'}], 'category_id': 73}, {'sent_ids': [55, 56], 'file_name': 'COCO_train2014_000000581657_6.jpg', 'ann_id': 1101817, 'ref_id': 19, 'image_id': 581657, 'split': 'train', 'sentences': [{'tokens': ['the', 'laptop', 'nearest', 'us'], 'raw': 'the laptop nearest us', 'sent_id': 55, 'sent': 'the laptop nearest us'}, {'tokens': ['monitor', 'left'], 'raw': 'monitor left', 'sent_id': 56, 'sent': 'monitor left'}], 'category_id': 73}, {'sent_ids': [57, 58], 'file_name': 'COCO_train2014_000000581657_4.jpg', 'ann_id': 556799, 'ref_id': 20, 'image_id': 581657, 'split': 'train', 'sentences': [{'tokens': ['hand', 'in', 'the', 'front', 'bottom', 'right'], 'raw': 'hand in the front bottom right', 'sent_id': 57, 'sent': 'hand in the front bottom right'}, {'tokens': ['fronnt', 'hand'], 'raw': 'fronnt hand', 'sent_id': 58, 'sent': 'fronnt hand'}], 'category_id': 1}, {'sent_ids': [59, 60, 61], 'file_name': 'COCO_train2014_000000581657_16.jpg', 'ann_id': 1758997, 'ref_id': 21, 'image_id': 581657, 'split': 'train', 'sentences': [{'tokens': ['upper', 'right', 'corner'], 'raw': 'Upper right corner', 'sent_id': 59, 'sent': 'upper right corner'}, {'tokens': ['top', 'right', 'of', 'image'], 'raw': 'top right of image', 'sent_id': 60, 'sent': 'top right of image'}, {'tokens': ['upper', 'right', 'corner'], 'raw': 'upper right corner', 'sent_id': 61, 'sent': 'upper right corner'}], 'category_id': 1}, {'sent_ids': [62, 63, 64], 'file_name': 'COCO_train2014_000000581629_6.jpg', 'ann_id': 2157900, 'ref_id': 22, 'image_id': 581629, 'split': 'train', 'sentences': [{'tokens': ['man', 'on', 'left', 'white', 'hat'], 'raw': 'man on left white hat', 'sent_id': 62, 'sent': 'man on left white hat'}, {'tokens': ['left', 'dude'], 'raw': 'left dude', 'sent_id': 63, 'sent': 'left dude'}, {'tokens': ['hat'], 'raw': 'hat', 'sent_id': 64, 'sent': 'hat'}], 'category_id': 1}, {'sent_ids': [65, 66, 67], 'file_name': 'COCO_train2014_000000581629_2.jpg', 'ann_id': 508442, 'ref_id': 23, 'image_id': 581629, 'split': 'train', 'sentences': [{'tokens': ['guy', 'on', 'right'], 'raw': 'guy on right', 'sent_id': 65, 'sent': 'guy on right'}, {'tokens': ['bald', 'man'], 'raw': 'bald man', 'sent_id': 66, 'sent': 'bald man'}, {'tokens': ['bald', 'guy'], 'raw': 'bald guy', 'sent_id': 67, 'sent': 'bald guy'}], 'category_id': 1}, {'sent_ids': [68, 69, 70], 'file_name': 'COCO_train2014_000000581629_1.jpg', 'ann_id': 500335, 'ref_id': 24, 'image_id': 581629, 'split': 'train', 'sentences': [{'tokens': ['center', 'girl'], 'raw': 'center girl', 'sent_id': 68, 'sent': 'center girl'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 69, 'sent': 'woman'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 70, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [71, 72, 73], 'file_name': 'COCO_train2014_000000581563_3.jpg', 'ann_id': 1345868, 'ref_id': 25, 'image_id': 581563, 'split': 'testB', 'sentences': [{'tokens': ['lower', 'left', 'corner', 'darkness'], 'raw': 'lower left corner darkness', 'sent_id': 71, 'sent': 'lower left corner darkness'}, {'tokens': ['bpttom', 'left', 'dark'], 'raw': 'bpttom left dark', 'sent_id': 72, 'sent': 'bpttom left dark'}, {'tokens': ['black', 'van', 'in', 'front', 'of', 'cab'], 'raw': 'black van in front of cab', 'sent_id': 73, 'sent': 'black van in front of cab'}], 'category_id': 3}, {'sent_ids': [74, 75, 76], 'file_name': 'COCO_train2014_000000581563_0.jpg', 'ann_id': 344837, 'ref_id': 26, 'image_id': 581563, 'split': 'testB', 'sentences': [{'tokens': ['taxi'], 'raw': 'Taxi', 'sent_id': 74, 'sent': 'taxi'}, {'tokens': ['the', 'taxi', 'cab', 'bottom', 'right'], 'raw': 'the taxi cab bottom right', 'sent_id': 75, 'sent': 'the taxi cab bottom right'}, {'tokens': ['taxi'], 'raw': 'taxi', 'sent_id': 76, 'sent': 'taxi'}], 'category_id': 3}, {'sent_ids': [77, 78, 79], 'file_name': 'COCO_train2014_000000581518_2.jpg', 'ann_id': 1082811, 'ref_id': 27, 'image_id': 581518, 'split': 'testB', 'sentences': [{'tokens': ['top', 'donut'], 'raw': 'top donut', 'sent_id': 77, 'sent': 'top donut'}, {'tokens': ['top', 'of', 'donuts'], 'raw': 'Top of donuts', 'sent_id': 78, 'sent': 'top of donuts'}, {'tokens': ['top', 'donut'], 'raw': 'top donut', 'sent_id': 79, 'sent': 'top donut'}], 'category_id': 60}, {'sent_ids': [80, 81, 82], 'file_name': 'COCO_train2014_000000581518_0.jpg', 'ann_id': 1081593, 'ref_id': 28, 'image_id': 581518, 'split': 'testB', 'sentences': [{'tokens': ['donut', 'wcolored', 'sprinkles'], 'raw': 'donut w/colored sprinkles', 'sent_id': 80, 'sent': 'donut wcolored sprinkles'}, {'tokens': ['middle', 'donut', 'with', 'sprinkles'], 'raw': 'middle donut with sprinkles', 'sent_id': 81, 'sent': 'middle donut with sprinkles'}, {'tokens': ['second', 'from', 'top'], 'raw': 'Second from top', 'sent_id': 82, 'sent': 'second from top'}], 'category_id': 60}, {'sent_ids': [83, 84, 85], 'file_name': 'COCO_train2014_000000581481_7.jpg', 'ann_id': 2218461, 'ref_id': 29, 'image_id': 581481, 'split': 'train', 'sentences': [{'tokens': ['right', 'half'], 'raw': 'right half', 'sent_id': 83, 'sent': 'right half'}, {'tokens': ['what', 'are', 'these', 'foods', 'thing', 'on', 'the', 'right'], 'raw': 'what are these foods! thing on the right', 'sent_id': 84, 'sent': 'what are these foods thing on the right'}, {'tokens': ['chicken'], 'raw': 'chicken', 'sent_id': 85, 'sent': 'chicken'}], 'category_id': 54}, {'sent_ids': [86, 87, 88], 'file_name': 'COCO_train2014_000000581481_0.jpg', 'ann_id': 309123, 'ref_id': 30, 'image_id': 581481, 'split': 'train', 'sentences': [{'tokens': ['food', 'left', 'with', 'onions'], 'raw': 'food left with onions', 'sent_id': 86, 'sent': 'food left with onions'}, {'tokens': ['the', 'carrots'], 'raw': 'the carrots', 'sent_id': 87, 'sent': 'the carrots'}, {'tokens': ['side', 'with', 'onion'], 'raw': 'side with onion', 'sent_id': 88, 'sent': 'side with onion'}], 'category_id': 54}, {'sent_ids': [89, 90, 91], 'file_name': 'COCO_train2014_000000581466_4.jpg', 'ann_id': 75700, 'ref_id': 31, 'image_id': 581466, 'split': 'train', 'sentences': [{'tokens': ['cow', 'on', 'left', 'front'], 'raw': 'cow on left front', 'sent_id': 89, 'sent': 'cow on left front'}, {'tokens': ['left', 'cow'], 'raw': 'left cow', 'sent_id': 90, 'sent': 'left cow'}, {'tokens': ['leftmost', 'animal', 'edge', 'of', 'pic'], 'raw': 'leftmost animal (edge of pic)', 'sent_id': 91, 'sent': 'leftmost animal edge of pic'}], 'category_id': 21}, {'sent_ids': [92, 93, 94], 'file_name': 'COCO_train2014_000000581466_1.jpg', 'ann_id': 71392, 'ref_id': 32, 'image_id': 581466, 'split': 'train', 'sentences': [{'tokens': ['cow', 'lying', 'down', 'on', 'right'], 'raw': 'cow lying down on right', 'sent_id': 92, 'sent': 'cow lying down on right'}, {'tokens': ['brown', 'white', 'cow', 'laying', 'down'], 'raw': 'brown white cow laying down', 'sent_id': 93, 'sent': 'brown white cow laying down'}, {'tokens': ['cow', 'sitting'], 'raw': 'cow sitting', 'sent_id': 94, 'sent': 'cow sitting'}], 'category_id': 21}, {'sent_ids': [95, 96, 97], 'file_name': 'COCO_train2014_000000581466_0.jpg', 'ann_id': 70901, 'ref_id': 33, 'image_id': 581466, 'split': 'train', 'sentences': [{'tokens': ['tail', 'of', 'cow', 'in', 'middle'], 'raw': 'tail  of cow in middle', 'sent_id': 95, 'sent': 'tail of cow in middle'}, {'tokens': ['middle', 'cow', 'butt'], 'raw': 'middle cow butt', 'sent_id': 96, 'sent': 'middle cow butt'}, {'tokens': ['cow', 'butt'], 'raw': 'cow butt', 'sent_id': 97, 'sent': 'cow butt'}], 'category_id': 21}, {'sent_ids': [98, 99, 100], 'file_name': 'COCO_train2014_000000581446_5.jpg', 'ann_id': 510191, 'ref_id': 34, 'image_id': 581446, 'split': 'train', 'sentences': [{'tokens': ['woman', 'in', 'white'], 'raw': 'woman in white', 'sent_id': 98, 'sent': 'woman in white'}, {'tokens': ['female', 'in', 'white', 'shorts', 'and', 'hat'], 'raw': 'female in white shorts and hat', 'sent_id': 99, 'sent': 'female in white shorts and hat'}, {'tokens': ['blue', 'shirt'], 'raw': 'blue shirt', 'sent_id': 100, 'sent': 'blue shirt'}], 'category_id': 1}, {'sent_ids': [101, 102, 103], 'file_name': 'COCO_train2014_000000581446_4.jpg', 'ann_id': 505664, 'ref_id': 35, 'image_id': 581446, 'split': 'train', 'sentences': [{'tokens': ['lady', 'in', 'black', 'on', 'right'], 'raw': 'LADY IN BLACK ON RIGHT', 'sent_id': 101, 'sent': 'lady in black on right'}, {'tokens': ['girl', 'in', 'black'], 'raw': 'girl in black', 'sent_id': 102, 'sent': 'girl in black'}, {'tokens': ['woman', 'in', 'black'], 'raw': 'woman in black', 'sent_id': 103, 'sent': 'woman in black'}], 'category_id': 1}, {'sent_ids': [104, 105], 'file_name': 'COCO_train2014_000000581425_6.jpg', 'ann_id': 2005581, 'ref_id': 36, 'image_id': 581425, 'split': 'train', 'sentences': [{'tokens': ['man', 'cut', 'face'], 'raw': 'man cut face', 'sent_id': 104, 'sent': 'man cut face'}, {'tokens': ['face', 'cut', 'out'], 'raw': 'face cut out', 'sent_id': 105, 'sent': 'face cut out'}], 'category_id': 1}, {'sent_ids': [106, 107, 108], 'file_name': 'COCO_train2014_000000581425_1.jpg', 'ann_id': 531973, 'ref_id': 37, 'image_id': 581425, 'split': 'train', 'sentences': [{'tokens': ['pirate', 'picture', 'on', 'cake'], 'raw': 'pirate picture on cake', 'sent_id': 106, 'sent': 'pirate picture on cake'}, {'tokens': ['picture', 'on', 'the', 'cake'], 'raw': 'picture on the cake', 'sent_id': 107, 'sent': 'picture on the cake'}, {'tokens': ['kid', 'in', 'pirate', 'hat'], 'raw': 'kid in pirate hat', 'sent_id': 108, 'sent': 'kid in pirate hat'}], 'category_id': 1}, {'sent_ids': [109, 110, 111], 'file_name': 'COCO_train2014_000000581425_0.jpg', 'ann_id': 490700, 'ref_id': 38, 'image_id': 581425, 'split': 'train', 'sentences': [{'tokens': ['fist'], 'raw': 'fist', 'sent_id': 109, 'sent': 'fist'}, {'tokens': ['fist'], 'raw': 'Fist', 'sent_id': 110, 'sent': 'fist'}, {'tokens': ['hand', 'in', 'top', 'right', 'corner'], 'raw': 'hand in top right corner', 'sent_id': 111, 'sent': 'hand in top right corner'}], 'category_id': 1}, {'sent_ids': [112, 113, 114], 'file_name': 'COCO_train2014_000000581419_4.jpg', 'ann_id': 1991154, 'ref_id': 39, 'image_id': 581419, 'split': 'train', 'sentences': [{'tokens': ['scale', 'bottom', 'right'], 'raw': 'scale bottom right', 'sent_id': 112, 'sent': 'scale bottom right'}, {'tokens': ['bottom', 'right', 'clock'], 'raw': 'bottom right clock', 'sent_id': 113, 'sent': 'bottom right clock'}, {'tokens': ['clock', 'on', 'bottom', 'right'], 'raw': 'clock on bottom right', 'sent_id': 114, 'sent': 'clock on bottom right'}], 'category_id': 85}, {'sent_ids': [115, 116, 117], 'file_name': 'COCO_train2014_000000581419_3.jpg', 'ann_id': 1991009, 'ref_id': 40, 'image_id': 581419, 'split': 'train', 'sentences': [{'tokens': ['bottom', 'left', 'clock'], 'raw': 'bottom left clock', 'sent_id': 115, 'sent': 'bottom left clock'}, {'tokens': ['clock', 'next', 'to', 'womans', 'left', 'foot'], 'raw': "clock next to woman's left foot", 'sent_id': 116, 'sent': 'clock next to womans left foot'}, {'tokens': ['bottom', 'left', 'clock'], 'raw': 'bottom left clock', 'sent_id': 117, 'sent': 'bottom left clock'}], 'category_id': 85}, {'sent_ids': [118, 119, 120], 'file_name': 'COCO_train2014_000000581419_1.jpg', 'ann_id': 337651, 'ref_id': 41, 'image_id': 581419, 'split': 'train', 'sentences': [{'tokens': ['top', 'on', 'left', 'clock'], 'raw': 'top on left clock', 'sent_id': 118, 'sent': 'top on left clock'}, {'tokens': ['top', 'left', 'clock'], 'raw': 'top left clock', 'sent_id': 119, 'sent': 'top left clock'}, {'tokens': ['top', 'left', 'corner', 'clock'], 'raw': 'top L corner clock', 'sent_id': 120, 'sent': 'top left corner clock'}], 'category_id': 85}, {'sent_ids': [121, 122, 123], 'file_name': 'COCO_train2014_000000581419_0.jpg', 'ann_id': 336962, 'ref_id': 42, 'image_id': 581419, 'split': 'train', 'sentences': [{'tokens': ['top', 'right', 'clock'], 'raw': 'top right clock', 'sent_id': 121, 'sent': 'top right clock'}, {'tokens': ['one', 'on', 'the', 'top', 'right'], 'raw': 'one on the top right', 'sent_id': 122, 'sent': 'one on the top right'}, {'tokens': ['upper', 'right', 'clock'], 'raw': 'upper right clock', 'sent_id': 123, 'sent': 'upper right clock'}], 'category_id': 85}, {'sent_ids': [124, 125, 126], 'file_name': 'COCO_train2014_000000581354_1.jpg', 'ann_id': 57804, 'ref_id': 43, 'image_id': 581354, 'split': 'train', 'sentences': [{'tokens': ['horse', 'in', 'front', 'close', 'up'], 'raw': 'horse in front close up', 'sent_id': 124, 'sent': 'horse in front close up'}, {'tokens': ['white', 'hair', 'front', 'horse'], 'raw': 'white hair front horse', 'sent_id': 125, 'sent': 'white hair front horse'}, {'tokens': ['horse', 'up', 'front'], 'raw': 'horse up front', 'sent_id': 126, 'sent': 'horse up front'}], 'category_id': 19}, {'sent_ids': [127, 128, 129], 'file_name': 'COCO_train2014_000000581354_0.jpg', 'ann_id': 55711, 'ref_id': 44, 'image_id': 581354, 'split': 'train', 'sentences': [{'tokens': ['far', 'horse', 'head'], 'raw': 'far horse head', 'sent_id': 127, 'sent': 'far horse head'}, {'tokens': ['horse', 'with', 'pink', 'girl', 'riding', 'on', 'it'], 'raw': 'horse with pink girl riding on it', 'sent_id': 128, 'sent': 'horse with pink girl riding on it'}, {'tokens': ['back', 'horse'], 'raw': 'back horse', 'sent_id': 129, 'sent': 'back horse'}], 'category_id': 19}, {'sent_ids': [130, 131, 132], 'file_name': 'COCO_train2014_000000581346_1.jpg', 'ann_id': 591091, 'ref_id': 45, 'image_id': 581346, 'split': 'testB', 'sentences': [{'tokens': ['left', 'zebra', 'butt'], 'raw': 'Left zebra butt', 'sent_id': 130, 'sent': 'left zebra butt'}, {'tokens': ['left', 'zebra', 'butt'], 'raw': 'left zebra butt', 'sent_id': 131, 'sent': 'left zebra butt'}, {'tokens': ['zebra', 'on', 'the', 'left'], 'raw': 'zebra on the left', 'sent_id': 132, 'sent': 'zebra on the left'}], 'category_id': 24}, {'sent_ids': [133, 134, 135], 'file_name': 'COCO_train2014_000000581346_0.jpg', 'ann_id': 588533, 'ref_id': 46, 'image_id': 581346, 'split': 'testB', 'sentences': [{'tokens': ['zebra', 'right', 'butt'], 'raw': 'zebra right butt', 'sent_id': 133, 'sent': 'zebra right butt'}, {'tokens': ['zebra', 'on', 'right'], 'raw': 'zebra on right', 'sent_id': 134, 'sent': 'zebra on right'}, {'tokens': ['right', 'zebra', 'butt'], 'raw': 'right zebra butt', 'sent_id': 135, 'sent': 'right zebra butt'}], 'category_id': 24}, {'sent_ids': [136, 137], 'file_name': 'COCO_train2014_000000581282_10.jpg', 'ann_id': 1313895, 'ref_id': 47, 'image_id': 581282, 'split': 'testA', 'sentences': [{'tokens': ['person', 'bottom', 'left'], 'raw': 'person bottom left', 'sent_id': 136, 'sent': 'person bottom left'}, {'tokens': ['left', 'black', 'shirt'], 'raw': 'left black shirt', 'sent_id': 137, 'sent': 'left black shirt'}], 'category_id': 1}, {'sent_ids': [138, 139], 'file_name': 'COCO_train2014_000000581258_2.jpg', 'ann_id': 459894, 'ref_id': 48, 'image_id': 581258, 'split': 'train', 'sentences': [{'tokens': ['main', 'person', 'in', 'photo', 'in', 'tie'], 'raw': 'main person in photo in tie', 'sent_id': 138, 'sent': 'main person in photo in tie'}, {'tokens': ['the', 'man', 'with', 'an', 'umbrella'], 'raw': 'The man with an umbrella.', 'sent_id': 139, 'sent': 'the man with an umbrella'}], 'category_id': 1}, {'sent_ids': [140, 141], 'file_name': 'COCO_train2014_000000581249_4.jpg', 'ann_id': 1816401, 'ref_id': 49, 'image_id': 581249, 'split': 'train', 'sentences': [{'tokens': ['cat', 'on', 'suit'], 'raw': 'cat on suit', 'sent_id': 140, 'sent': 'cat on suit'}, {'tokens': ['black', 'and', 'white', 'kitty'], 'raw': 'black and white kitty', 'sent_id': 141, 'sent': 'black and white kitty'}], 'category_id': 17}, {'sent_ids': [142, 143, 144], 'file_name': 'COCO_train2014_000000581249_3.jpg', 'ann_id': 48922, 'ref_id': 50, 'image_id': 581249, 'split': 'train', 'sentences': [{'tokens': ['cat', 'bottomleft'], 'raw': 'cat bottomleft', 'sent_id': 142, 'sent': 'cat bottomleft'}, {'tokens': ['left', 'cat'], 'raw': 'left cat', 'sent_id': 143, 'sent': 'left cat'}, {'tokens': ['cat', 'on', 'floor'], 'raw': 'cat on floor', 'sent_id': 144, 'sent': 'cat on floor'}], 'category_id': 17}, {'sent_ids': [145, 146, 147], 'file_name': 'COCO_train2014_000000581227_2.jpg', 'ann_id': 538268, 'ref_id': 51, 'image_id': 581227, 'split': 'train', 'sentences': [{'tokens': ['far', 'left', 'player'], 'raw': 'Far left player', 'sent_id': 145, 'sent': 'far left player'}, {'tokens': ['left', 'player'], 'raw': 'left player', 'sent_id': 146, 'sent': 'left player'}, {'tokens': ['left', 'player'], 'raw': 'left player', 'sent_id': 147, 'sent': 'left player'}], 'category_id': 1}, {'sent_ids': [148, 149, 150], 'file_name': 'COCO_train2014_000000581227_1.jpg', 'ann_id': 534500, 'ref_id': 52, 'image_id': 581227, 'split': 'train', 'sentences': [{'tokens': ['right', 'girl'], 'raw': 'right girl', 'sent_id': 148, 'sent': 'right girl'}, {'tokens': ['girl', 'closest', 'to', 'us'], 'raw': 'girl closest to us', 'sent_id': 149, 'sent': 'girl closest to us'}, {'tokens': ['girl', 'in', 'front', 'cam'], 'raw': 'girl in front cam', 'sent_id': 150, 'sent': 'girl in front cam'}], 'category_id': 1}, {'sent_ids': [151, 152, 153], 'file_name': 'COCO_train2014_000000581199_5.jpg', 'ann_id': 1074443, 'ref_id': 53, 'image_id': 581199, 'split': 'train', 'sentences': [{'tokens': ['pizza', 'up', 'front'], 'raw': 'pizza up front', 'sent_id': 151, 'sent': 'pizza up front'}, {'tokens': ['click', 'on', 'the', 'food', 'in', 'the', 'foreground'], 'raw': 'CLICK ON THE FOOD IN THE FOREGROUND', 'sent_id': 152, 'sent': 'click on the food in the foreground'}, {'tokens': ['pizzzza'], 'raw': 'pizzzza', 'sent_id': 153, 'sent': 'pizzzza'}], 'category_id': 59}, {'sent_ids': [154, 155, 156], 'file_name': 'COCO_train2014_000000581199_4.jpg', 'ann_id': 1073591, 'ref_id': 54, 'image_id': 581199, 'split': 'train', 'sentences': [{'tokens': ['pizza', 'back', 'right'], 'raw': 'pizza back right', 'sent_id': 154, 'sent': 'pizza back right'}, {'tokens': ['pizza', 'on', 'right'], 'raw': 'pizza on right', 'sent_id': 155, 'sent': 'pizza on right'}, {'tokens': ['pizza', 'in', 'back'], 'raw': 'pizza in back', 'sent_id': 156, 'sent': 'pizza in back'}], 'category_id': 59}, {'sent_ids': [157, 158, 159], 'file_name': 'COCO_train2014_000000581199_2.jpg', 'ann_id': 464938, 'ref_id': 55, 'image_id': 581199, 'split': 'train', 'sentences': [{'tokens': ['plaid'], 'raw': 'plaid', 'sent_id': 157, 'sent': 'plaid'}, {'tokens': ['plaid', 'shirt', 'on', 'right'], 'raw': 'plaid shirt on right', 'sent_id': 158, 'sent': 'plaid shirt on right'}, {'tokens': ['plaid', 'shirt'], 'raw': 'plaid shirt', 'sent_id': 159, 'sent': 'plaid shirt'}], 'category_id': 1}, {'sent_ids': [160, 161, 162], 'file_name': 'COCO_train2014_000000581199_1.jpg', 'ann_id': 445980, 'ref_id': 56, 'image_id': 581199, 'split': 'train', 'sentences': [{'tokens': ['person', 'on', 'the', 'left'], 'raw': 'person on the left', 'sent_id': 160, 'sent': 'person on the left'}, {'tokens': ['person', 'in', 'white'], 'raw': 'PERSON IN WHITE', 'sent_id': 161, 'sent': 'person in white'}, {'tokens': ['person', 'on', 'left', 'side'], 'raw': 'Person on left side', 'sent_id': 162, 'sent': 'person on left side'}], 'category_id': 1}, {'sent_ids': [163, 164, 165], 'file_name': 'COCO_train2014_000000581198_4.jpg', 'ann_id': 516597, 'ref_id': 57, 'image_id': 581198, 'split': 'train', 'sentences': [{'tokens': ['straps'], 'raw': 'straps', 'sent_id': 163, 'sent': 'straps'}, {'tokens': ['top', 'left', 'corner', 'of', 'pic'], 'raw': 'top left corner of pic', 'sent_id': 164, 'sent': 'top left corner of pic'}, {'tokens': ['top', 'left', 'corner'], 'raw': 'top left corner', 'sent_id': 165, 'sent': 'top left corner'}], 'category_id': 1}, {'sent_ids': [166, 167, 168], 'file_name': 'COCO_train2014_000000581198_3.jpg', 'ann_id': 484402, 'ref_id': 58, 'image_id': 581198, 'split': 'train', 'sentences': [{'tokens': ['person', 'in', 'background', 'in', 'striped', 'shirt'], 'raw': 'person in background in striped shirt', 'sent_id': 166, 'sent': 'person in background in striped shirt'}, {'tokens': ['strip', 'shirt', 'boy', 'top', 'right'], 'raw': 'strip shirt boy top right', 'sent_id': 167, 'sent': 'strip shirt boy top right'}, {'tokens': ['striped', 'shirt'], 'raw': 'Striped shirt', 'sent_id': 168, 'sent': 'striped shirt'}], 'category_id': 1}, {'sent_ids': [169, 170, 171], 'file_name': 'COCO_train2014_000000581198_23.jpg', 'ann_id': 2163529, 'ref_id': 59, 'image_id': 581198, 'split': 'train', 'sentences': [{'tokens': ['woman', 'looking', 'at', 'you'], 'raw': 'woman looking at you', 'sent_id': 169, 'sent': 'woman looking at you'}, {'tokens': ['the', 'girl', 'looking', 'at', 'cam'], 'raw': 'The girl looking at cam', 'sent_id': 170, 'sent': 'the girl looking at cam'}, {'tokens': ['girl', 'looking', 'at', 'you'], 'raw': 'girl looking at you', 'sent_id': 171, 'sent': 'girl looking at you'}], 'category_id': 1}, {'sent_ids': [172, 173, 174], 'file_name': 'COCO_train2014_000000581198_18.jpg', 'ann_id': 1757650, 'ref_id': 60, 'image_id': 581198, 'split': 'train', 'sentences': [{'tokens': ['head', 'of', 'person', 'woman', 'looking', 'at', 'bottom'], 'raw': 'head of person woman looking at bottom', 'sent_id': 172, 'sent': 'head of person woman looking at bottom'}, {'tokens': ['blurred', 'head', 'left', 'of', 'the', 'woman'], 'raw': 'blurred head left of the woman', 'sent_id': 173, 'sent': 'blurred head left of the woman'}, {'tokens': ['top', 'of', 'head', 'bottom', 'middle'], 'raw': 'top of head bottom middle', 'sent_id': 174, 'sent': 'top of head bottom middle'}], 'category_id': 1}, {'sent_ids': [175, 176, 177], 'file_name': 'COCO_train2014_000000581196_0.jpg', 'ann_id': 174739, 'ref_id': 61, 'image_id': 581196, 'split': 'train', 'sentences': [{'tokens': ['train'], 'raw': 'Train', 'sent_id': 175, 'sent': 'train'}, {'tokens': ['train'], 'raw': 'train', 'sent_id': 176, 'sent': 'train'}, {'tokens': ['train'], 'raw': 'TRAIN', 'sent_id': 177, 'sent': 'train'}], 'category_id': 7}, {'sent_ids': [178, 179, 180], 'file_name': 'COCO_train2014_000000581136_9.jpg', 'ann_id': 1943799, 'ref_id': 62, 'image_id': 581136, 'split': 'train', 'sentences': [{'tokens': ['striped', 'chair', 'by', 'the', 'piano'], 'raw': 'striped chair by the piano', 'sent_id': 178, 'sent': 'striped chair by the piano'}, {'tokens': ['right', 'chair', 'facing', 'us'], 'raw': 'right chair facing us', 'sent_id': 179, 'sent': 'right chair facing us'}, {'tokens': ['right', 'most', 'chair', 'kinda', 'dark'], 'raw': 'right most chair (kinda dark)', 'sent_id': 180, 'sent': 'right most chair kinda dark'}], 'category_id': 62}, {'sent_ids': [181, 182, 183], 'file_name': 'COCO_train2014_000000581136_2.jpg', 'ann_id': 117142, 'ref_id': 63, 'image_id': 581136, 'split': 'train', 'sentences': [{'tokens': ['couch', 'arm', 'bottom', 'right'], 'raw': 'Couch arm bottom right', 'sent_id': 181, 'sent': 'couch arm bottom right'}, {'tokens': ['couch'], 'raw': 'couch', 'sent_id': 182, 'sent': 'couch'}, {'tokens': ['sofa', 'on', 'right', 'cut', 'off'], 'raw': 'sofa on right cut off', 'sent_id': 183, 'sent': 'sofa on right cut off'}], 'category_id': 63}, {'sent_ids': [184, 185], 'file_name': 'COCO_train2014_000000581136_12.jpg', 'ann_id': 1949970, 'ref_id': 64, 'image_id': 581136, 'split': 'train', 'sentences': [{'tokens': ['chair', 'on', 'other', 'side', 'of', 'table'], 'raw': 'chair on other side of table', 'sent_id': 184, 'sent': 'chair on other side of table'}, {'tokens': ['striped', 'chair', 'furthest', 'right'], 'raw': 'striped chair furthest right', 'sent_id': 185, 'sent': 'striped chair furthest right'}], 'category_id': 63}, {'sent_ids': [186, 187, 188], 'file_name': 'COCO_train2014_000000581136_1.jpg', 'ann_id': 113430, 'ref_id': 65, 'image_id': 581136, 'split': 'train', 'sentences': [{'tokens': ['couch', 'on', 'the', 'left'], 'raw': 'Couch on the left', 'sent_id': 186, 'sent': 'couch on the left'}, {'tokens': ['striped', 'chair', 'middle'], 'raw': 'striped chair, middle', 'sent_id': 187, 'sent': 'striped chair middle'}, {'tokens': ['chair'], 'raw': 'chair', 'sent_id': 188, 'sent': 'chair'}], 'category_id': 63}, {'sent_ids': [189, 190, 191], 'file_name': 'COCO_train2014_000000581136_0.jpg', 'ann_id': 103387, 'ref_id': 66, 'image_id': 581136, 'split': 'train', 'sentences': [{'tokens': ['chair', 'front', 'center'], 'raw': 'chair front center', 'sent_id': 189, 'sent': 'chair front center'}, {'tokens': ['striped', 'couch'], 'raw': 'striped couch', 'sent_id': 190, 'sent': 'striped couch'}, {'tokens': ['near', 'chair'], 'raw': 'near chair', 'sent_id': 191, 'sent': 'near chair'}], 'category_id': 62}, {'sent_ids': [192, 193, 194], 'file_name': 'COCO_train2014_000000581108_0.jpg', 'ann_id': 152760, 'ref_id': 67, 'image_id': 581108, 'split': 'train', 'sentences': [{'tokens': ['front', 'center', 'bike'], 'raw': 'front center bike', 'sent_id': 192, 'sent': 'front center bike'}, {'tokens': ['motorcycle', 'nearest', 'to', 'us'], 'raw': 'motorcycle nearest to us', 'sent_id': 193, 'sent': 'motorcycle nearest to us'}, {'tokens': ['middle', 'bike'], 'raw': 'middle bike', 'sent_id': 194, 'sent': 'middle bike'}], 'category_id': 4}, {'sent_ids': [195, 196, 197], 'file_name': 'COCO_train2014_000000581057_7.jpg', 'ann_id': 1791082, 'ref_id': 68, 'image_id': 581057, 'split': 'train', 'sentences': [{'tokens': ['main', 'bike'], 'raw': 'main bike', 'sent_id': 195, 'sent': 'main bike'}, {'tokens': ['13'], 'raw': '#13', 'sent_id': 196, 'sent': '13'}, {'tokens': ['main', 'bike'], 'raw': 'Main bike', 'sent_id': 197, 'sent': 'main bike'}], 'category_id': 4}, {'sent_ids': [198, 199, 200], 'file_name': 'COCO_train2014_000000581057_5.jpg', 'ann_id': 246698, 'ref_id': 69, 'image_id': 581057, 'split': 'train', 'sentences': [{'tokens': ['far', 'left', 'front', 'cycle'], 'raw': 'far left front cycle', 'sent_id': 198, 'sent': 'far left front cycle'}, {'tokens': ['half', 'bike', 'far', 'left'], 'raw': 'half bike, far left', 'sent_id': 199, 'sent': 'half bike far left'}, {'tokens': ['bottom', 'left', 'corner'], 'raw': 'bottom left corner', 'sent_id': 200, 'sent': 'bottom left corner'}], 'category_id': 4}, {'sent_ids': [201, 202, 203], 'file_name': 'COCO_train2014_000000581057_4.jpg', 'ann_id': 245539, 'ref_id': 70, 'image_id': 581057, 'split': 'train', 'sentences': [{'tokens': ['tire', 'on', 'blue', 'motorcycle'], 'raw': 'tire on blue motorcycle', 'sent_id': 201, 'sent': 'tire on blue motorcycle'}, {'tokens': ['right', 'bike', 'in', 'between', 'white', 'shirt', 'and', 'black', 'shirt'], 'raw': 'RIGHT BIKE IN BETWEEN WHITE SHIRT AND BLACK SHIRT', 'sent_id': 202, 'sent': 'right bike in between white shirt and black shirt'}, {'tokens': ['on', 'the', 'back', 'carrying'], 'raw': 'on the back carrying', 'sent_id': 203, 'sent': 'on the back carrying'}], 'category_id': 4}, {'sent_ids': [204, 205, 206], 'file_name': 'COCO_train2014_000000581057_1.jpg', 'ann_id': 215446, 'ref_id': 71, 'image_id': 581057, 'split': 'train', 'sentences': [{'tokens': ['right', 'top', 'white', 'shirt'], 'raw': 'right top white shirt', 'sent_id': 204, 'sent': 'right top white shirt'}, {'tokens': ['right', 'top', 'white', 'shirt'], 'raw': 'right top white shirt', 'sent_id': 205, 'sent': 'right top white shirt'}, {'tokens': ['man', 'in', 'white'], 'raw': 'man in white', 'sent_id': 206, 'sent': 'man in white'}], 'category_id': 1}, {'sent_ids': [207, 208, 209], 'file_name': 'COCO_train2014_000000581057_0.jpg', 'ann_id': 202407, 'ref_id': 72, 'image_id': 581057, 'split': 'train', 'sentences': [{'tokens': ['right', 'dark', 'guy'], 'raw': 'R DARK GUY', 'sent_id': 207, 'sent': 'right dark guy'}, {'tokens': ['black', 'shape', 'far', 'right'], 'raw': 'black shape far right', 'sent_id': 208, 'sent': 'black shape far right'}, {'tokens': ['black', 'shirt', 'right', 'edge'], 'raw': 'Black shirt right edge', 'sent_id': 209, 'sent': 'black shirt right edge'}], 'category_id': 1}, {'sent_ids': [210, 211, 212], 'file_name': 'COCO_train2014_000000581021_4.jpg', 'ann_id': 591324, 'ref_id': 73, 'image_id': 581021, 'split': 'train', 'sentences': [{'tokens': ['zebra', 'closer', 'to', 'you'], 'raw': 'zebra closer to you', 'sent_id': 210, 'sent': 'zebra closer to you'}, {'tokens': ['front', 'zebra'], 'raw': 'front zebra', 'sent_id': 211, 'sent': 'front zebra'}, {'tokens': ['zebra', 'in', 'the', 'front'], 'raw': 'zebra in the front', 'sent_id': 212, 'sent': 'zebra in the front'}], 'category_id': 24}, {'sent_ids': [213, 214, 215], 'file_name': 'COCO_train2014_000000581021_1.jpg', 'ann_id': 589140, 'ref_id': 74, 'image_id': 581021, 'split': 'train', 'sentences': [{'tokens': ['zebra', 'on', 'the', 'right'], 'raw': 'Zebra on the right', 'sent_id': 213, 'sent': 'zebra on the right'}, {'tokens': ['right', 'zebra'], 'raw': 'right zebra', 'sent_id': 214, 'sent': 'right zebra'}, {'tokens': ['right', 'zebra'], 'raw': 'right zebra', 'sent_id': 215, 'sent': 'right zebra'}], 'category_id': 24}, {'sent_ids': [216, 217, 218], 'file_name': 'COCO_train2014_000000581009_2.jpg', 'ann_id': 528547, 'ref_id': 75, 'image_id': 581009, 'split': 'train', 'sentences': [{'tokens': ['woman'], 'raw': 'woman', 'sent_id': 216, 'sent': 'woman'}, {'tokens': ['girl', 'on', 'skateboard'], 'raw': 'girl on skateboard', 'sent_id': 217, 'sent': 'girl on skateboard'}, {'tokens': ['pink', 'shirt'], 'raw': 'pink shirt', 'sent_id': 218, 'sent': 'pink shirt'}], 'category_id': 1}, {'sent_ids': [219, 220, 221], 'file_name': 'COCO_train2014_000000581009_1.jpg', 'ann_id': 489887, 'ref_id': 76, 'image_id': 581009, 'split': 'train', 'sentences': [{'tokens': ['man', 'on', 'left'], 'raw': 'man on left', 'sent_id': 219, 'sent': 'man on left'}, {'tokens': ['boy'], 'raw': 'boy', 'sent_id': 220, 'sent': 'boy'}, {'tokens': ['man', 'in', 'white'], 'raw': 'man in white', 'sent_id': 221, 'sent': 'man in white'}], 'category_id': 1}, {'sent_ids': [222, 223, 224, 225], 'file_name': 'COCO_train2014_000000580957_4.jpg', 'ann_id': 1537681, 'ref_id': 77, 'image_id': 580957, 'split': 'val', 'sentences': [{'tokens': ['bowl', 'behind', 'the', 'others', 'can', 'only', 'see', 'part'], 'raw': 'bowl behind the others can only see part', 'sent_id': 222, 'sent': 'bowl behind the others can only see part'}, {'tokens': ['dish', 'in', 'top', 'right', 'corner'], 'raw': 'Dish in top right corner', 'sent_id': 223, 'sent': 'dish in top right corner'}, {'tokens': ['white', 'dish', 'in', 'the', 'top', 'right', 'corner'], 'raw': 'White dish in the top right corner.', 'sent_id': 224, 'sent': 'white dish in the top right corner'}, {'tokens': ['white', 'pot', 'upper', 'right', 'corner'], 'raw': 'white pot upper right corner', 'sent_id': 225, 'sent': 'white pot upper right corner'}], 'category_id': 51}, {'sent_ids': [226, 227, 228, 229], 'file_name': 'COCO_train2014_000000580957_2.jpg', 'ann_id': 710706, 'ref_id': 78, 'image_id': 580957, 'split': 'val', 'sentences': [{'tokens': ['front', 'bowl', 'wcarrots', 'in', 'it'], 'raw': 'front bowl w/carrots in it', 'sent_id': 226, 'sent': 'front bowl wcarrots in it'}, {'tokens': ['bowl', 'of', 'carrots'], 'raw': 'bowl of carrots', 'sent_id': 227, 'sent': 'bowl of carrots'}, {'tokens': ['bowl', 'of', 'carrots'], 'raw': 'bowl of carrots', 'sent_id': 228, 'sent': 'bowl of carrots'}, {'tokens': ['carrots'], 'raw': 'carrots', 'sent_id': 229, 'sent': 'carrots'}], 'category_id': 51}, {'sent_ids': [230, 231, 232], 'file_name': 'COCO_train2014_000000580945_6.jpg', 'ann_id': 480045, 'ref_id': 79, 'image_id': 580945, 'split': 'train', 'sentences': [{'tokens': ['woman', 'in', 'scarf'], 'raw': 'woman in scarf', 'sent_id': 230, 'sent': 'woman in scarf'}, {'tokens': ['woman', 'on', 'the', 'left', 'white', 'scard'], 'raw': 'woman on the left - white scard', 'sent_id': 231, 'sent': 'woman on the left white scard'}, {'tokens': ['woman', 'with', 'scarf'], 'raw': 'woman with scarf', 'sent_id': 232, 'sent': 'woman with scarf'}], 'category_id': 1}, {'sent_ids': [233, 234, 235], 'file_name': 'COCO_train2014_000000580945_5.jpg', 'ann_id': 460124, 'ref_id': 80, 'image_id': 580945, 'split': 'train', 'sentences': [{'tokens': ['lady', 'on', 'the', 'right'], 'raw': 'lady on the right', 'sent_id': 233, 'sent': 'lady on the right'}, {'tokens': ['woman', 'next', 'to', 'man'], 'raw': 'woman next to man', 'sent_id': 234, 'sent': 'woman next to man'}, {'tokens': ['lady', 'with', 'glasses'], 'raw': 'lady with glasses', 'sent_id': 235, 'sent': 'lady with glasses'}], 'category_id': 1}, {'sent_ids': [236, 237, 238], 'file_name': 'COCO_train2014_000000580945_4.jpg', 'ann_id': 439008, 'ref_id': 81, 'image_id': 580945, 'split': 'train', 'sentences': [{'tokens': ['man'], 'raw': 'man', 'sent_id': 236, 'sent': 'man'}, {'tokens': ['man', 'in', 'blue', 'and', 'red', 'jacket'], 'raw': 'man in blue and red jacket', 'sent_id': 237, 'sent': 'man in blue and red jacket'}, {'tokens': ['man', 'in', 'blue', 'jacket', 'with', 'red', 'sleeves'], 'raw': 'man in blue jacket with red sleeves', 'sent_id': 238, 'sent': 'man in blue jacket with red sleeves'}], 'category_id': 1}, {'sent_ids': [239, 240, 241], 'file_name': 'COCO_train2014_000000580919_5.jpg', 'ann_id': 1207959, 'ref_id': 82, 'image_id': 580919, 'split': 'train', 'sentences': [{'tokens': ['person', 'with', 'backpackdont', 'click', 'the', 'bag', 'click', 'the', 'person'], 'raw': 'person with backpack--dont click the bag, click the person', 'sent_id': 239, 'sent': 'person with backpackdont click the bag click the person'}, {'tokens': ['biege', 'shorts'], 'raw': 'biege shorts', 'sent_id': 240, 'sent': 'biege shorts'}, {'tokens': ['man', 'walking', 'dog'], 'raw': 'man walking dog', 'sent_id': 241, 'sent': 'man walking dog'}], 'category_id': 1}, {'sent_ids': [242, 243, 244], 'file_name': 'COCO_train2014_000000580913_2.jpg', 'ann_id': 2117621, 'ref_id': 83, 'image_id': 580913, 'split': 'train', 'sentences': [{'tokens': ['food', 'to', 'right', 'of', 'pizza'], 'raw': 'food to right of pizza', 'sent_id': 242, 'sent': 'food to right of pizza'}, {'tokens': ['food', 'towards', 'right', 'edge'], 'raw': 'food towards right edge', 'sent_id': 243, 'sent': 'food towards right edge'}, {'tokens': ['right', 'slice'], 'raw': 'right slice', 'sent_id': 244, 'sent': 'right slice'}], 'category_id': 59}, {'sent_ids': [245, 246, 247], 'file_name': 'COCO_train2014_000000580913_0.jpg', 'ann_id': 1072388, 'ref_id': 84, 'image_id': 580913, 'split': 'train', 'sentences': [{'tokens': ['food', 'being', 'held'], 'raw': 'food being held', 'sent_id': 245, 'sent': 'food being held'}, {'tokens': ['food', 'in', 'hand'], 'raw': 'food in hand', 'sent_id': 246, 'sent': 'food in hand'}, {'tokens': ['bread', 'slice'], 'raw': 'bread slice', 'sent_id': 247, 'sent': 'bread slice'}], 'category_id': 59}, {'sent_ids': [248, 249, 250], 'file_name': 'COCO_train2014_000000580905_2.jpg', 'ann_id': 480908, 'ref_id': 85, 'image_id': 580905, 'split': 'val', 'sentences': [{'tokens': ['little', 'girl'], 'raw': 'little girl', 'sent_id': 248, 'sent': 'little girl'}, {'tokens': ['pink'], 'raw': 'pink', 'sent_id': 249, 'sent': 'pink'}, {'tokens': ['your', 'monitors', 'colors', 'off', 'friend', 'p', 'pink', 'shirt', 'girl'], 'raw': "Your monitor's color's off, friend. ;p Pink shirt girl...", 'sent_id': 250, 'sent': 'your monitors colors off friend p pink shirt girl'}], 'category_id': 1}, {'sent_ids': [251, 252, 253], 'file_name': 'COCO_train2014_000000580905_1.jpg', 'ann_id': 469475, 'ref_id': 86, 'image_id': 580905, 'split': 'val', 'sentences': [{'tokens': ['green', 'woman'], 'raw': 'green woman', 'sent_id': 251, 'sent': 'green woman'}, {'tokens': ['person', 'holding', 'umbrella'], 'raw': 'person holding umbrella', 'sent_id': 252, 'sent': 'person holding umbrella'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 253, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [254, 255, 256], 'file_name': 'COCO_train2014_000000580851_3.jpg', 'ann_id': 343754, 'ref_id': 87, 'image_id': 580851, 'split': 'train', 'sentences': [{'tokens': ['far', 'right', 'toothbrush'], 'raw': 'far right toothbrush', 'sent_id': 254, 'sent': 'far right toothbrush'}, {'tokens': ['the', 'furthest', 'toothbrush', 'to', 'the', 'right'], 'raw': 'the furthest toothbrush to the right', 'sent_id': 255, 'sent': 'the furthest toothbrush to the right'}, {'tokens': ['most', 'right', 'brush', 'in', 'the', 'back'], 'raw': 'most right brush in the back', 'sent_id': 256, 'sent': 'most right brush in the back'}], 'category_id': 90}, {'sent_ids': [257, 258, 259], 'file_name': 'COCO_train2014_000000580851_2.jpg', 'ann_id': 343558, 'ref_id': 88, 'image_id': 580851, 'split': 'train', 'sentences': [{'tokens': ['first', 'toothbrush', 'on', 'the', 'right'], 'raw': 'first toothbrush on the right', 'sent_id': 257, 'sent': 'first toothbrush on the right'}, {'tokens': ['second', 'from', 'right', 'brush'], 'raw': '2nd from right brush', 'sent_id': 258, 'sent': 'second from right brush'}, {'tokens': ['second', 'brush', 'from', 'the', 'right'], 'raw': '2nd brush from the right', 'sent_id': 259, 'sent': 'second brush from the right'}], 'category_id': 90}, {'sent_ids': [260, 261, 262], 'file_name': 'COCO_train2014_000000580851_1.jpg', 'ann_id': 343179, 'ref_id': 89, 'image_id': 580851, 'split': 'train', 'sentences': [{'tokens': ['toothbrush', 'in', 'center', 'with', 'yellow', 'bristles'], 'raw': 'toothbrush in center with yellow bristles', 'sent_id': 260, 'sent': 'toothbrush in center with yellow bristles'}, {'tokens': ['middle', 'toothbrush'], 'raw': 'middle toothbrush', 'sent_id': 261, 'sent': 'middle toothbrush'}, {'tokens': ['yellow', 'toothbrush'], 'raw': 'yellow toothbrush', 'sent_id': 262, 'sent': 'yellow toothbrush'}], 'category_id': 90}, {'sent_ids': [263, 264, 265], 'file_name': 'COCO_train2014_000000580851_0.jpg', 'ann_id': 342398, 'ref_id': 90, 'image_id': 580851, 'split': 'train', 'sentences': [{'tokens': ['toothbrush', 'second', 'from', 'left'], 'raw': 'toothbrush second from left', 'sent_id': 263, 'sent': 'toothbrush second from left'}, {'tokens': ['brush', 'second', 'from', 'left'], 'raw': 'brush second from left', 'sent_id': 264, 'sent': 'brush second from left'}, {'tokens': ['toothbrush', 'front', 'left'], 'raw': 'toothbrush, front left', 'sent_id': 265, 'sent': 'toothbrush front left'}], 'category_id': 90}, {'sent_ids': [266, 267, 268], 'file_name': 'COCO_train2014_000000580849_7.jpg', 'ann_id': 2191253, 'ref_id': 91, 'image_id': 580849, 'split': 'train', 'sentences': [{'tokens': ['boy', 'wpurple', 'tie'], 'raw': 'boy w/purple tie', 'sent_id': 266, 'sent': 'boy wpurple tie'}, {'tokens': ['purple', 'tie'], 'raw': 'purple tie', 'sent_id': 267, 'sent': 'purple tie'}, {'tokens': ['middle', 'kid', 'purple', 'tie'], 'raw': 'middle kid purple tie', 'sent_id': 268, 'sent': 'middle kid purple tie'}], 'category_id': 1}, {'sent_ids': [269, 270], 'file_name': 'COCO_train2014_000000580849_6.jpg', 'ann_id': 2191061, 'ref_id': 92, 'image_id': 580849, 'split': 'train', 'sentences': [{'tokens': ['boy', 'with', 'blue', 'tie', 'blond', 'hair'], 'raw': 'boy with blue tie, blonde hair', 'sent_id': 269, 'sent': 'boy with blue tie blond hair'}, {'tokens': ['blondie', 'boy', 'with', 'blue', 'tie'], 'raw': 'blondie boy w blue tie', 'sent_id': 270, 'sent': 'blondie boy with blue tie'}], 'category_id': 1}, {'sent_ids': [271, 272], 'file_name': 'COCO_train2014_000000580849_5.jpg', 'ann_id': 2158396, 'ref_id': 93, 'image_id': 580849, 'split': 'train', 'sentences': [{'tokens': ['blond', 'hair', 'close', 'to', 'us', 'on', 'right'], 'raw': 'blonde hair close to us on right', 'sent_id': 271, 'sent': 'blond hair close to us on right'}, {'tokens': ['hair', 'in', 'front'], 'raw': 'hair in front', 'sent_id': 272, 'sent': 'hair in front'}], 'category_id': 1}, {'sent_ids': [273, 274], 'file_name': 'COCO_train2014_000000580849_4.jpg', 'ann_id': 1729858, 'ref_id': 94, 'image_id': 580849, 'split': 'train', 'sentences': [{'tokens': ['first', 'boy', 'from', 'the', 'left'], 'raw': 'first boy from the left', 'sent_id': 273, 'sent': 'first boy from the left'}, {'tokens': ['left', 'man'], 'raw': 'LEFT MAN', 'sent_id': 274, 'sent': 'left man'}], 'category_id': 1}, {'sent_ids': [275, 276, 277], 'file_name': 'COCO_train2014_000000580849_2.jpg', 'ann_id': 539594, 'ref_id': 95, 'image_id': 580849, 'split': 'train', 'sentences': [{'tokens': ['girl', 'next', 'to', 'blazer', 'guy'], 'raw': 'girl next to blazer guy', 'sent_id': 275, 'sent': 'girl next to blazer guy'}, {'tokens': ['person', 'with', 'one', 'rose'], 'raw': 'person with one rose', 'sent_id': 276, 'sent': 'person with one rose'}, {'tokens': ['second', 'girl', 'from', 'left'], 'raw': '2nd girl from left', 'sent_id': 277, 'sent': 'second girl from left'}], 'category_id': 1}, {'sent_ids': [278, 279, 280], 'file_name': 'COCO_train2014_000000580843_3.jpg', 'ann_id': 1938201, 'ref_id': 96, 'image_id': 580843, 'split': 'train', 'sentences': [{'tokens': ['lol', 'right', 'seat'], 'raw': 'lol: right seat', 'sent_id': 278, 'sent': 'lol right seat'}, {'tokens': ['right', 'seat'], 'raw': 'Right seat', 'sent_id': 279, 'sent': 'right seat'}, {'tokens': ['seat', 'on', 'right'], 'raw': 'seat on right', 'sent_id': 280, 'sent': 'seat on right'}], 'category_id': 62}, {'sent_ids': [281, 282, 283], 'file_name': 'COCO_train2014_000000580843_2.jpg', 'ann_id': 1600280, 'ref_id': 97, 'image_id': 580843, 'split': 'train', 'sentences': [{'tokens': ['blue', 'seat', 'on', 'left'], 'raw': 'blue seat on left', 'sent_id': 281, 'sent': 'blue seat on left'}, {'tokens': ['click', 'the', 'seat', 'just', 'above', 'suitcase', 'handle'], 'raw': 'click the seat just above suitcase handle', 'sent_id': 282, 'sent': 'click the seat just above suitcase handle'}, {'tokens': ['the', 'seat', 'were', 'the', 'bag', 'is'], 'raw': 'the seat were the bag is', 'sent_id': 283, 'sent': 'the seat were the bag is'}], 'category_id': 62}, {'sent_ids': [284, 285], 'file_name': 'COCO_train2014_000000580837_9.jpg', 'ann_id': 2167429, 'ref_id': 98, 'image_id': 580837, 'split': 'train', 'sentences': [{'tokens': ['mans', 'arm', 'in', 'far', 'left'], 'raw': 'mans arm in far left', 'sent_id': 284, 'sent': 'mans arm in far left'}, {'tokens': ['far', 'left', 'partial', 'person'], 'raw': 'far left partial person', 'sent_id': 285, 'sent': 'far left partial person'}], 'category_id': 1}, {'sent_ids': [286, 287, 288], 'file_name': 'COCO_train2014_000000580837_4.jpg', 'ann_id': 1709642, 'ref_id': 99, 'image_id': 580837, 'split': 'train', 'sentences': [{'tokens': ['man', 'with', 'blue', 'shirt'], 'raw': 'man with blue shirt', 'sent_id': 286, 'sent': 'man with blue shirt'}, {'tokens': ['left', 'tie', 'guy'], 'raw': 'left tie guy', 'sent_id': 287, 'sent': 'left tie guy'}, {'tokens': ['left', 'male'], 'raw': 'left male', 'sent_id': 288, 'sent': 'left male'}], 'category_id': 1...
                """
            if not len(cat_ids) == 0:
                refs = [ref for ref in refs if ref['category_id'] in cat_ids]
            if not len(ref_ids) == 0:
                refs = [ref for ref in refs if ref['ref_id'] in ref_ids]
            if not len(split) == 0:
                if split in ['testA', 'testB', 'testC']:
                    refs = [ref for ref in refs if split[-1] in ref['split']]  # we also consider testAB, testBC, ...
                elif split in ['testAB', 'testBC', 'testAC']:
                    refs = [ref for ref in refs if ref['split'] == split]  # rarely used I guess...
                elif split == 'test':
                    refs = [ref for ref in refs if 'test' in ref['split']]
                elif split == 'train' or split == 'val':
                    refs = [ref for ref in refs if ref['split'] == split]
                    """
                    refs shape : 3811 -> dict 8
                    refs : [{'sent_ids': [222, 223, 224, 225], 'file_name': 'COCO_train2014_000000580957_4.jpg', 'ann_id': 1537681, 'ref_id': 77, 'image_id': 580957, 'split': 'val', 'sentences': [{'tokens': ['bowl', 'behind', 'the', 'others', 'can', 'only', 'see', 'part'], 'raw': 'bowl behind the others can only see part', 'sent_id': 222, 'sent': 'bowl behind the others can only see part'}, {'tokens': ['dish', 'in', 'top', 'right', 'corner'], 'raw': 'Dish in top right corner', 'sent_id': 223, 'sent': 'dish in top right corner'}, {'tokens': ['white', 'dish', 'in', 'the', 'top', 'right', 'corner'], 'raw': 'White dish in the top right corner.', 'sent_id': 224, 'sent': 'white dish in the top right corner'}, {'tokens': ['white', 'pot', 'upper', 'right', 'corner'], 'raw': 'white pot upper right corner', 'sent_id': 225, 'sent': 'white pot upper right corner'}], 'category_id': 51}, {'sent_ids': [226, 227, 228, 229], 'file_name': 'COCO_train2014_000000580957_2.jpg', 'ann_id': 710706, 'ref_id': 78, 'image_id': 580957, 'split': 'val', 'sentences': [{'tokens': ['front', 'bowl', 'wcarrots', 'in', 'it'], 'raw': 'front bowl w/carrots in it', 'sent_id': 226, 'sent': 'front bowl wcarrots in it'}, {'tokens': ['bowl', 'of', 'carrots'], 'raw': 'bowl of carrots', 'sent_id': 227, 'sent': 'bowl of carrots'}, {'tokens': ['bowl', 'of', 'carrots'], 'raw': 'bowl of carrots', 'sent_id': 228, 'sent': 'bowl of carrots'}, {'tokens': ['carrots'], 'raw': 'carrots', 'sent_id': 229, 'sent': 'carrots'}], 'category_id': 51}, {'sent_ids': [248, 249, 250], 'file_name': 'COCO_train2014_000000580905_2.jpg', 'ann_id': 480908, 'ref_id': 85, 'image_id': 580905, 'split': 'val', 'sentences': [{'tokens': ['little', 'girl'], 'raw': 'little girl', 'sent_id': 248, 'sent': 'little girl'}, {'tokens': ['pink'], 'raw': 'pink', 'sent_id': 249, 'sent': 'pink'}, {'tokens': ['your', 'monitors', 'colors', 'off', 'friend', 'p', 'pink', 'shirt', 'girl'], 'raw': "Your monitor's color's off, friend. ;p Pink shirt girl...", 'sent_id': 250, 'sent': 'your monitors colors off friend p pink shirt girl'}], 'category_id': 1}, {'sent_ids': [251, 252, 253], 'file_name': 'COCO_train2014_000000580905_1.jpg', 'ann_id': 469475, 'ref_id': 86, 'image_id': 580905, 'split': 'val', 'sentences': [{'tokens': ['green', 'woman'], 'raw': 'green woman', 'sent_id': 251, 'sent': 'green woman'}, {'tokens': ['person', 'holding', 'umbrella'], 'raw': 'person holding umbrella', 'sent_id': 252, 'sent': 'person holding umbrella'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 253, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [292, 293, 294], 'file_name': 'COCO_train2014_000000580785_3.jpg', 'ann_id': 1746473, 'ref_id': 101, 'image_id': 580785, 'split': 'val', 'sentences': [{'tokens': ['mom'], 'raw': 'mom', 'sent_id': 292, 'sent': 'mom'}, {'tokens': ['adult'], 'raw': 'adult', 'sent_id': 293, 'sent': 'adult'}, {'tokens': ['lady', 'sitting'], 'raw': 'lady sitting', 'sent_id': 294, 'sent': 'lady sitting'}], 'category_id': 1}, {'sent_ids': [295, 296, 297], 'file_name': 'COCO_train2014_000000580785_2.jpg', 'ann_id': 1741008, 'ref_id': 102, 'image_id': 580785, 'split': 'val', 'sentences': [{'tokens': ['child', 'sitting', 'on', 'womans', 'lap'], 'raw': 'child sitting on womans lap', 'sent_id': 295, 'sent': 'child sitting on womans lap'}, {'tokens': ['small', 'girl', 'on', 'lap'], 'raw': 'small girl on lap', 'sent_id': 296, 'sent': 'small girl on lap'}, {'tokens': ['child'], 'raw': 'child', 'sent_id': 297, 'sent': 'child'}], 'category_id': 1}, {'sent_ids': [438, 439], 'file_name': 'COCO_train2014_000000580374_2.jpg', 'ann_id': 190137, 'ref_id': 151, 'image_id': 580374, 'split': 'val', 'sentences': [{'tokens': ['left', 'guy'], 'raw': 'left guy', 'sent_id': 438, 'sent': 'left guy'}, {'tokens': ['man', 'on', 'left'], 'raw': 'man on left', 'sent_id': 439, 'sent': 'man on left'}], 'category_id': 1}, {'sent_ids': [511, 512], 'file_name': 'COCO_train2014_000000580008_2.jpg', 'ann_id': 514243, 'ref_id': 177, 'image_id': 580008, 'split': 'val', 'sentences': [{'tokens': ['lady', 'on', 'right'], 'raw': 'lady on right', 'sent_id': 511, 'sent': 'lady on right'}, {'tokens': ['upper', 'right', 'woman'], 'raw': 'upper right woman', 'sent_id': 512, 'sent': 'upper right woman'}], 'category_id': 1}, {'sent_ids': [513, 514, 515], 'file_name': 'COCO_train2014_000000580008_12.jpg', 'ann_id': 2159030, 'ref_id': 178, 'image_id': 580008, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'box', 'left', 'dude'], 'raw': 'bottom box left dude', 'sent_id': 513, 'sent': 'bottom box left dude'}, {'tokens': ['guy', 'wearing', 'glasses'], 'raw': 'guy wearing glasses', 'sent_id': 514, 'sent': 'guy wearing glasses'}, {'tokens': ['bottom', 'picleft', 'guy'], 'raw': 'bottom pic..left guy', 'sent_id': 515, 'sent': 'bottom picleft guy'}], 'category_id': 1}, {'sent_ids': [516, 517, 518], 'file_name': 'COCO_train2014_000000580008_1.jpg', 'ann_id': 507653, 'ref_id': 179, 'image_id': 580008, 'split': 'val', 'sentences': [{'tokens': ['woman', 'in', 'top', 'picture', 'on', 'the', 'left'], 'raw': 'Woman in top picture on the left.', 'sent_id': 516, 'sent': 'woman in top picture on the left'}, {'tokens': ['woman', 'upper', 'left'], 'raw': 'woman upper left', 'sent_id': 517, 'sent': 'woman upper left'}, {'tokens': ['top', 'left', 'woman'], 'raw': 'top left woman', 'sent_id': 518, 'sent': 'top left woman'}], 'category_id': 1}, {'sent_ids': [519, 520, 521], 'file_name': 'COCO_train2014_000000580008_0.jpg', 'ann_id': 442199, 'ref_id': 180, 'image_id': 580008, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'right', 'guy'], 'raw': 'bottom right guy', 'sent_id': 519, 'sent': 'bottom right guy'}, {'tokens': ['man', 'on', 'bottom', 'right'], 'raw': 'man on bottom right', 'sent_id': 520, 'sent': 'man on bottom right'}, {'tokens': ['man', 'right', 'bottom'], 'raw': 'Man right bottom', 'sent_id': 521, 'sent': 'man right bottom'}], 'category_id': 1}, {'sent_ids': [568, 569, 570], 'file_name': 'COCO_train2014_000000579667_3.jpg', 'ann_id': 50194, 'ref_id': 198, 'image_id': 579667, 'split': 'val', 'sentences': [{'tokens': ['cat', 'on', 'top'], 'raw': 'cat on top', 'sent_id': 568, 'sent': 'cat on top'}, {'tokens': ['cat', 'on', 'the', 'top'], 'raw': 'cat on the top', 'sent_id': 569, 'sent': 'cat on the top'}, {'tokens': ['cat', 'at', 'faucet'], 'raw': 'Cat at faucet', 'sent_id': 570, 'sent': 'cat at faucet'}], 'category_id': 17}, {'sent_ids': [571, 572, 573], 'file_name': 'COCO_train2014_000000579667_2.jpg', 'ann_id': 49369, 'ref_id': 199, 'image_id': 579667, 'split': 'val', 'sentences': [{'tokens': ['black', 'cat', 'under', 'sink'], 'raw': 'black cat under sink', 'sent_id': 571, 'sent': 'black cat under sink'}, {'tokens': ['under'], 'raw': 'under', 'sent_id': 572, 'sent': 'under'}, {'tokens': ['bottom', 'cat'], 'raw': 'Bottom cat', 'sent_id': 573, 'sent': 'bottom cat'}], 'category_id': 17}, {'sent_ids': [615, 616, 617], 'file_name': 'COCO_train2014_000000579440_1.jpg', 'ann_id': 473903, 'ref_id': 215, 'image_id': 579440, 'split': 'val', 'sentences': [{'tokens': ['man', 'standing'], 'raw': 'Man standing', 'sent_id': 615, 'sent': 'man standing'}, {'tokens': ['man'], 'raw': 'man', 'sent_id': 616, 'sent': 'man'}, {'tokens': ['guy', 'standing', 'playing', 'wiifit'], 'raw': 'guy standing playing wiifit', 'sent_id': 617, 'sent': 'guy standing playing wiifit'}], 'category_id': 1}, {'sent_ids': [618, 619, 620], 'file_name': 'COCO_train2014_000000579440_0.jpg', 'ann_id': 466635, 'ref_id': 216, 'image_id': 579440, 'split': 'val', 'sentences': [{'tokens': ['person', 'in', 'chair', 'at', 'left'], 'raw': 'person in chair at left', 'sent_id': 618, 'sent': 'person in chair at left'}, {'tokens': ['guy', 'sitting', 'on', 'left'], 'raw': 'guy sitting on left', 'sent_id': 619, 'sent': 'guy sitting on left'}, {'tokens': ['black', 'shirt', 'in', 'chair', 'on', 'left'], 'raw': 'black shirt in chair on left', 'sent_id': 620, 'sent': 'black shirt in chair on left'}], 'category_id': 1}, {'sent_ids': [788, 789, 790], 'file_name': 'COCO_train2014_000000578808_3.jpg', 'ann_id': 2162742, 'ref_id': 276, 'image_id': 578808, 'split': 'val', 'sentences': [{'tokens': ['gurl'], 'raw': 'gurl', 'sent_id': 788, 'sent': 'gurl'}, {'tokens': ['girl', 'in', 'purple'], 'raw': 'girl in purple', 'sent_id': 789, 'sent': 'girl in purple'}, {'tokens': ['child', 'in', 'front'], 'raw': 'child in front', 'sent_id': 790, 'sent': 'child in front'}], 'category_id': 1}, {'sent_ids': [791, 792, 793], 'file_name': 'COCO_train2014_000000578808_0.jpg', 'ann_id': 513538, 'ref_id': 277, 'image_id': 578808, 'split': 'val', 'sentences': [{'tokens': ['woman', 'in', 'shorts'], 'raw': 'woman in shorts', 'sent_id': 791, 'sent': 'woman in shorts'}, {'tokens': ['right', 'chick'], 'raw': 'right chick', 'sent_id': 792, 'sent': 'right chick'}, {'tokens': ['man', 'on', 'right', 'in', 'shorts', 'elephant', 'wants', 'to', 'charge'], 'raw': 'man on right in shorts, elephant wants to charge', 'sent_id': 793, 'sent': 'man on right in shorts elephant wants to charge'}], 'category_id': 1}, {'sent_ids': [794, 795, 796], 'file_name': 'COCO_train2014_000000578805_8.jpg', 'ann_id': 1743532, 'ref_id': 278, 'image_id': 578805, 'split': 'val', 'sentences': [{'tokens': ['psn', 'boy'], 'raw': 'psn boy', 'sent_id': 794, 'sent': 'psn boy'}, {'tokens': ['left', 'kid'], 'raw': 'left kid', 'sent_id': 795, 'sent': 'left kid'}, {'tokens': ['kid', 'on', 'left', 'in', 'blue'], 'raw': 'kid on left in blue', 'sent_id': 796, 'sent': 'kid on left in blue'}], 'category_id': 1}, {'sent_ids': [797, 798], 'file_name': 'COCO_train2014_000000578805_4.jpg', 'ann_id': 485679, 'ref_id': 279, 'image_id': 578805, 'split': 'val', 'sentences': [{'tokens': ['boy', 'in', 'black', 'shirt', 'front', 'right'], 'raw': 'boy in black shirt front right', 'sent_id': 797, 'sent': 'boy in black shirt front right'}, {'tokens': ['boy', 'on', 'right'], 'raw': 'boy on right', 'sent_id': 798, 'sent': 'boy on right'}], 'category_id': 1}, {'sent_ids': [799, 800, 801], 'file_name': 'COCO_train2014_000000578805_3.jpg', 'ann_id': 477161, 'ref_id': 280, 'image_id': 578805, 'split': 'val', 'sentences': [{'tokens': ['kid', 'on', 'right', 'in', 'back', 'blondish', 'hair'], 'raw': 'kid on right in back, blondish hair', 'sent_id': 799, 'sent': 'kid on right in back blondish hair'}, {'tokens': ['blond', 'boy', 'on', 'right'], 'raw': 'blonde boy on right', 'sent_id': 800, 'sent': 'blond boy on right'}, {'tokens': ['top', 'right', 'kid'], 'raw': 'top right kid', 'sent_id': 801, 'sent': 'top right kid'}], 'category_id': 1}, {'sent_ids': [802, 803, 804], 'file_name': 'COCO_train2014_000000578805_13.jpg', 'ann_id': 2151037, 'ref_id': 281, 'image_id': 578805, 'split': 'val', 'sentences': [{'tokens': ['girl', 'pink'], 'raw': 'girl pink', 'sent_id': 802, 'sent': 'girl pink'}, {'tokens': ['pink', 'gir'], 'raw': 'Pink gir', 'sent_id': 803, 'sent': 'pink gir'}, {'tokens': ['girl', 'back', 'left', 'pink'], 'raw': 'girl back left pink', 'sent_id': 804, 'sent': 'girl back left pink'}], 'category_id': 1}, {'sent_ids': [1122, 1123, 1124], 'file_name': 'COCO_train2014_000000577583_3.jpg', 'ann_id': 512572, 'ref_id': 395, 'image_id': 577583, 'split': 'val', 'sentences': [{'tokens': ['person', 'in', 'white', 'sleeping', 'far', 'away'], 'raw': 'person in white sleeping far away', 'sent_id': 1122, 'sent': 'person in white sleeping far away'}, {'tokens': ['sleeping', 'guy', 'in', 'back'], 'raw': 'SLEEPING GUY IN BACK', 'sent_id': 1123, 'sent': 'sleeping guy in back'}, {'tokens': ['man', 'sleeping', 'top'], 'raw': 'man sleeping top', 'sent_id': 1124, 'sent': 'man sleeping top'}], 'category_id': 1}, {'sent_ids': [1125, 1126, 1127], 'file_name': 'COCO_train2014_000000577583_2.jpg', 'ann_id': 506210, 'ref_id': 396, 'image_id': 577583, 'split': 'val', 'sentences': [{'tokens': ['lady', 'on', 'left', 'laying', 'on', 'bed'], 'raw': 'LADY ON LEFT LAYING ON BED', 'sent_id': 1125, 'sent': 'lady on left laying on bed'}, {'tokens': ['asleep'], 'raw': 'asleep', 'sent_id': 1126, 'sent': 'asleep'}, {'tokens': ['sleeping', 'woman'], 'raw': 'sleeping woman', 'sent_id': 1127, 'sent': 'sleeping woman'}], 'category_id': 1}, {'sent_ids': [1128, 1129], 'file_name': 'COCO_train2014_000000577558_1.jpg', 'ann_id': 310197, 'ref_id': 397, 'image_id': 577558, 'split': 'val', 'sentences': [{'tokens': ['left', 'sandwich'], 'raw': 'left sandwich', 'sent_id': 1128, 'sent': 'left sandwich'}, {'tokens': ['left', 'sandwich'], 'raw': 'left sandwich', 'sent_id': 1129, 'sent': 'left sandwich'}], 'category_id': 54}, {'sent_ids': [1130, 1131, 1132], 'file_name': 'COCO_train2014_000000577558_0.jpg', 'ann_id': 308201, 'ref_id': 398, 'image_id': 577558, 'split': 'val', 'sentences': [{'tokens': ['green', 'vegetable', 'with', 'leaves'], 'raw': 'green vegetable with leaves', 'sent_id': 1130, 'sent': 'green vegetable with leaves'}, {'tokens': ['green', 'vegie'], 'raw': 'green vegie', 'sent_id': 1131, 'sent': 'green vegie'}, {'tokens': ['sandwich', 'on', 'right'], 'raw': 'sandwich on right', 'sent_id': 1132, 'sent': 'sandwich on right'}], 'category_id': 54}, {'sent_ids': [1167, 1168, 1169], 'file_name': 'COCO_train2014_000000577399_5.jpg', 'ann_id': 2229146, 'ref_id': 412, 'image_id': 577399, 'split': 'val', 'sentences': [{'tokens': ['left', 'person', 'with', 'elbow', 'bent'], 'raw': 'left person with elbow bent', 'sent_id': 1167, 'sent': 'left person with elbow bent'}, {'tokens': ['girl', 'at', 'the', 'sink'], 'raw': 'girl at the sink', 'sent_id': 1168, 'sent': 'girl at the sink'}, {'tokens': ['smaller', 'child', 'over', 'sink'], 'raw': 'smaller child over sink', 'sent_id': 1169, 'sent': 'smaller child over sink'}], 'category_id': 1}, {'sent_ids': [1170, 1171, 1172], 'file_name': 'COCO_train2014_000000577399_4.jpg', 'ann_id': 2229114, 'ref_id': 413, 'image_id': 577399, 'split': 'val', 'sentences': [{'tokens': ['girl', 'brushing', 'teeth'], 'raw': 'girl brushing teeth', 'sent_id': 1170, 'sent': 'girl brushing teeth'}, {'tokens': ['girl', 'brushing', 'teeth'], 'raw': 'girl brushing teeth', 'sent_id': 1171, 'sent': 'girl brushing teeth'}, {'tokens': ['girl', 'brush', 'front'], 'raw': 'girl brush front', 'sent_id': 1172, 'sent': 'girl brush front'}], 'category_id': 1}, {'sent_ids': [1320, 1321, 1322], 'file_name': 'COCO_train2014_000000576829_1.jpg', 'ann_id': 1612703, 'ref_id': 465, 'image_id': 576829, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'right'], 'raw': 'BOTTOM R.', 'sent_id': 1320, 'sent': 'bottom right'}, {'tokens': ['bed', 'on', 'right', 'bottom', 'corner'], 'raw': 'bed on right bottom corner', 'sent_id': 1321, 'sent': 'bed on right bottom corner'}, {'tokens': ['the', 'sheets', 'on', 'the', 'bed', 'in', 'the', 'bottom', 'right', 'corner'], 'raw': 'the sheets on the bed in the bottom right corner', 'sent_id': 1322, 'sent': 'the sheets on the bed in the bottom right corner'}], 'category_id': 65}, {'sent_ids': [1323, 1324, 1325], 'file_name': 'COCO_train2014_000000576829_0.jpg', 'ann_id': 318326, 'ref_id': 466, 'image_id': 576829, 'split': 'val', 'sentences': [{'tokens': ['quilt'], 'raw': 'quilt', 'sent_id': 1323, 'sent': 'quilt'}, {'tokens': ['bed'], 'raw': 'bed', 'sent_id': 1324, 'sent': 'bed'}, {'tokens': ['bedspread'], 'raw': 'bedspread', 'sent_id': 1325, 'sent': 'bedspread'}], 'category_id': 65}, {'sent_ids': [1400, 1401, 1402], 'file_name': 'COCO_train2014_000000576581_1.jpg', 'ann_id': 592560, 'ref_id': 492, 'image_id': 576581, 'split': 'val', 'sentences': [{'tokens': ['zebra', 'on', 'left'], 'raw': 'zebra on left', 'sent_id': 1400, 'sent': 'zebra on left'}, {'tokens': ['a', 'black', 'and', 'white', 'striped', 'animal', 'on', 'the', 'left'], 'raw': 'A black and white striped animal on the left', 'sent_id': 1401, 'sent': 'a black and white striped animal on the left'}, {'tokens': ['the', 'fully', 'visible', 'zebra'], 'raw': 'The fully visible zebra', 'sent_id': 1402, 'sent': 'the fully visible zebra'}], 'category_id': 24}, {'sent_ids': [1403, 1404, 1405], 'file_name': 'COCO_train2014_000000576581_0.jpg', 'ann_id': 589225, 'ref_id': 493, 'image_id': 576581, 'split': 'val', 'sentences': [{'tokens': ['right', 'zebra'], 'raw': 'right zebra', 'sent_id': 1403, 'sent': 'right zebra'}, {'tokens': ['right', 'zebra'], 'raw': 'right zebra', 'sent_id': 1404, 'sent': 'right zebra'}, {'tokens': ['butt', 'zebra', 'cut', 'in', 'half'], 'raw': 'butt zebra, cut in half', 'sent_id': 1405, 'sent': 'butt zebra cut in half'}], 'category_id': 24}, {'sent_ids': [1622, 1623, 1624], 'file_name': 'COCO_train2014_000000575826_2.jpg', 'ann_id': 1737905, 'ref_id': 571, 'image_id': 575826, 'split': 'val', 'sentences': [{'tokens': ['man', 'in', 'black', 'coat'], 'raw': 'man in black coat', 'sent_id': 1622, 'sent': 'man in black coat'}, {'tokens': ['referee'], 'raw': 'referee', 'sent_id': 1623, 'sent': 'referee'}, {'tokens': ['guy', 'in', 'khakis'], 'raw': 'guy in khakis', 'sent_id': 1624, 'sent': 'guy in khakis'}], 'category_id': 1}, {'sent_ids': [1625, 1626, 1627], 'file_name': 'COCO_train2014_000000575826_1.jpg', 'ann_id': 503052, 'ref_id': 572, 'image_id': 575826, 'split': 'val', 'sentences': [{'tokens': ['hitter'], 'raw': 'hitter', 'sent_id': 1625, 'sent': 'hitter'}, {'tokens': ['player'], 'raw': 'player', 'sent_id': 1626, 'sent': 'player'}, {'tokens': ['tennis', 'player', 'in', 'white', 'shirt'], 'raw': 'tennis player in white shirt', 'sent_id': 1627, 'sent': 'tennis player in white shirt'}], 'category_id': 1}, {'sent_ids': [1728, 1729, 1730], 'file_name': 'COCO_train2014_000000575461_3.jpg', 'ann_id': 507574, 'ref_id': 610, 'image_id': 575461, 'split': 'val', 'sentences': [{'tokens': ['u2', 'man', 'on', 'left'], 'raw': 'U2! Man on left', 'sent_id': 1728, 'sent': 'u2 man on left'}, {'tokens': ['dude', 'in', 'blue', 'shirt', 'tie'], 'raw': 'dude in blue shirt tie', 'sent_id': 1729, 'sent': 'dude in blue shirt tie'}, {'tokens': ['man'], 'raw': 'Man', 'sent_id': 1730, 'sent': 'man'}], 'category_id': 1}, {'sent_ids': [1731, 1732, 1733], 'file_name': 'COCO_train2014_000000575461_2.jpg', 'ann_id': 462898, 'ref_id': 611, 'image_id': 575461, 'split': 'val', 'sentences': [{'tokens': ['lady'], 'raw': 'lady', 'sent_id': 1731, 'sent': 'lady'}, {'tokens': ['pink'], 'raw': 'pink', 'sent_id': 1732, 'sent': 'pink'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 1733, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [1797, 1798, 1799], 'file_name': 'COCO_train2014_000000574870_1.jpg', 'ann_id': 522236, 'ref_id': 633, 'image_id': 574870, 'split': 'val', 'sentences': [{'tokens': ['woman', 'on', 'left'], 'raw': 'Woman on left', 'sent_id': 1797, 'sent': 'woman on left'}, {'tokens': ['the', 'lady', 'on', 'the', 'left'], 'raw': 'The lady on the left', 'sent_id': 1798, 'sent': 'the lady on the left'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 1799, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [1800, 1801], 'file_name': 'COCO_train2014_000000574870_0.jpg', 'ann_id': 517830, 'ref_id': 634, 'image_id': 574870, 'split': 'val', 'sentences': [{'tokens': ['man', 'right'], 'raw': 'man right', 'sent_id': 1800, 'sent': 'man right'}, {'tokens': ['guy', 'on', 'right'], 'raw': 'Guy on right', 'sent_id': 1801, 'sent': 'guy on right'}], 'category_id': 1}, {'sent_ids': [1936, 1937], 'file_name': 'COCO_train2014_000000574251_3.jpg', 'ann_id': 1187884, 'ref_id': 681, 'image_id': 574251, 'split': 'val', 'sentences': [{'tokens': ['bag', 'on', 'far', 'left'], 'raw': 'bag on far left', 'sent_id': 1936, 'sent': 'bag on far left'}, {'tokens': ['first', 'case', 'on', 'left'], 'raw': 'first case on left', 'sent_id': 1937, 'sent': 'first case on left'}], 'category_id': 33}, {'sent_ids': [1938, 1939, 1940], 'file_name': 'COCO_train2014_000000574251_2.jpg', 'ann_id': 1187343, 'ref_id': 682, 'image_id': 574251, 'split': 'val', 'sentences': [{'tokens': ['second', 'bag', 'from', 'left'], 'raw': 'second bag from left', 'sent_id': 1938, 'sent': 'second bag from left'}, {'tokens': ['second', 'suitcase', 'from', 'left'], 'raw': 'second suitcase from left', 'sent_id': 1939, 'sent': 'second suitcase from left'}, {'tokens': ['second', 'suitcase', 'from', 'left'], 'raw': 'second suitcase from left', 'sent_id': 1940, 'sent': 'second suitcase from left'}], 'category_id': 33}, {'sent_ids': [1941, 1942, 1943], 'file_name': 'COCO_train2014_000000574251_1.jpg', 'ann_id': 1186557, 'ref_id': 683, 'image_id': 574251, 'split': 'val', 'sentences': [{'tokens': ['third', 'from', 'left'], 'raw': '3rd from left', 'sent_id': 1941, 'sent': 'third from left'}, {'tokens': ['suitcase', 'second', 'from', 'right'], 'raw': 'suitcase 2nd from right', 'sent_id': 1942, 'sent': 'suitcase second from right'}, {'tokens': ['third', 'from', 'left'], 'raw': '3rd from left', 'sent_id': 1943, 'sent': 'third from left'}], 'category_id': 33}, {'sent_ids': [1944, 1945, 1946], 'file_name': 'COCO_train2014_000000574251_0.jpg', 'ann_id': 1183421, 'ref_id': 684, 'image_id': 574251, 'split': 'val', 'sentences': [{'tokens': ['right', 'one'], 'raw': 'right one', 'sent_id': 1944, 'sent': 'right one'}, {'tokens': ['far', 'right', 'luggage'], 'raw': 'far right luggage', 'sent_id': 1945, 'sent': 'far right luggage'}, {'tokens': ['right', 'suitcase'], 'raw': 'right suitcase', 'sent_id': 1946, 'sent': 'right suitcase'}], 'category_id': 33}, {'sent_ids': [2038, 2039, 2040], 'file_name': 'COCO_train2014_000000573875_1.jpg', 'ann_id': 152712, 'ref_id': 717, 'image_id': 573875, 'split': 'val', 'sentences': [{'tokens': ['bike', 'on', 'right'], 'raw': 'bike on right', 'sent_id': 2038, 'sent': 'bike on right'}, {'tokens': ['cycle', 'in', 'back'], 'raw': 'CYCLE IN BACK', 'sent_id': 2039, 'sent': 'cycle in back'}, {'tokens': ['back', 'cycle'], 'raw': 'BACK CYCLE', 'sent_id': 2040, 'sent': 'back cycle'}], 'category_id': 4}, {'sent_ids': [2041, 2042, 2043], 'file_name': 'COCO_train2014_000000573875_0.jpg', 'ann_id': 152563, 'ref_id': 718, 'image_id': 573875, 'split': 'val', 'sentences': [{'tokens': ['first', 'bike'], 'raw': 'first bike', 'sent_id': 2041, 'sent': 'first bike'}, {'tokens': ['left', 'bike'], 'raw': 'left bike', 'sent_id': 2042, 'sent': 'left bike'}, {'tokens': ['front', 'bike'], 'raw': 'front bike', 'sent_id': 2043, 'sent': 'front bike'}], 'category_id': 4}, {'sent_ids': [2117, 2118, 2119], 'file_name': 'COCO_train2014_000000573632_7.jpg', 'ann_id': 711120, 'ref_id': 745, 'image_id': 573632, 'split': 'val', 'sentences': [{'tokens': ['top', 'left', 'bowl'], 'raw': 'top left bowl', 'sent_id': 2117, 'sent': 'top left bowl'}, {'tokens': ['yogart', 'on', 'left'], 'raw': 'yogart on left', 'sent_id': 2118, 'sent': 'yogart on left'}, {'tokens': ['top', 'left', 'bowl'], 'raw': 'top left bowl', 'sent_id': 2119, 'sent': 'top left bowl'}], 'category_id': 51}, {'sent_ids': [2120, 2121, 2122], 'file_name': 'COCO_train2014_000000573632_6.jpg', 'ann_id': 710670, 'ref_id': 746, 'image_id': 573632, 'split': 'val', 'sentences': [{'tokens': ['top', 'right', 'bowl'], 'raw': 'top right bowl', 'sent_id': 2120, 'sent': 'top right bowl'}, {'tokens': ['upper', 'right', 'bowl'], 'raw': 'upper right bowl', 'sent_id': 2121, 'sent': 'upper right bowl'}, {'tokens': ['top', 'right', 'bowl'], 'raw': 'top right bowl', 'sent_id': 2122, 'sent': 'top right bowl'}], 'category_id': 51}, {'sent_ids': [2123, 2124], 'file_name': 'COCO_train2014_000000573632_1.jpg', 'ann_id': 309992, 'ref_id': 747, 'image_id': 573632, 'split': 'val', 'sentences': [{'tokens': ['right', 'sandwhich', 'left', 'half'], 'raw': 'right sandwhich, left half', 'sent_id': 2123, 'sent': 'right sandwhich left half'}, {'tokens': ['left', 'half', 'of', 'right', 'sandwich'], 'raw': 'left half of right sandwich', 'sent_id': 2124, 'sent': 'left half of right sandwich'}], 'category_id': 54}, {'sent_ids': [2125, 2126], 'file_name': 'COCO_train2014_000000573632_0.jpg', 'ann_id': 309964, 'ref_id': 748, 'image_id': 573632, 'split': 'val', 'sentences': [{'tokens': ['the', 'first', 'half', 'of', 'the', 'sandwich', 'to', 'the', 'left'], 'raw': 'the first half of the sandwich to the left', 'sent_id': 2125, 'sent': 'the first half of the sandwich to the left'}, {'tokens': ['left', 'sandwich', 'bottom'], 'raw': 'left sandwich bottom', 'sent_id': 2126, 'sent': 'left sandwich bottom'}], 'category_id': 54}, {'sent_ids': [2179, 2180, 2181], 'file_name': 'COCO_train2014_000000573125_7.jpg', 'ann_id': 1206800, 'ref_id': 768, 'image_id': 573125, 'split': 'val', 'sentences': [{'tokens': ['blue', 'shirt'], 'raw': 'blue shirt', 'sent_id': 2179, 'sent': 'blue shirt'}, {'tokens': ['man', 'in', 'blue', 'shirt', 'holding', 'scissors'], 'raw': 'man in blue shirt holding scissors', 'sent_id': 2180, 'sent': 'man in blue shirt holding scissors'}, {'tokens': ['man', 'in', 'blue', 'shirt'], 'raw': 'man in blue shirt', 'sent_id': 2181, 'sent': 'man in blue shirt'}], 'category_id': 1}, {'sent_ids': [2182, 2183, 2184], 'file_name': 'COCO_train2014_000000573125_14.jpg', 'ann_id': 1313153, 'ref_id': 769, 'image_id': 573125, 'split': 'val', 'sentences': [{'tokens': ['guy', 'in', 'middle', 'of', 'pic', 'white', 'shirt'], 'raw': 'guy in middle of pic white shirt', 'sent_id': 2182, 'sent': 'guy in middle of pic white shirt'}, {'tokens': ['dude', 'in', 'white', 'shirt', 'in', 'middle'], 'raw': 'dude in white shirt in middle', 'sent_id': 2183, 'sent': 'dude in white shirt in middle'}, {'tokens': ['guy', 'white', 'shirt', 'with', 'shorts', 'and', 'strap'], 'raw': 'guy white shirt with shorts and strap', 'sent_id': 2184, 'sent': 'guy white shirt with shorts and strap'}], 'category_id': 1}, {'sent_ids': [2185, 2186, 2187], 'file_name': 'COCO_train2014_000000573125_13.jpg', 'ann_id': 1308939, 'ref_id': 770, 'image_id': 573125, 'split': 'val', 'sentences': [{'tokens': ['back', 'of', 'head', 'of', 'person', 'at', 'the', 'bottom'], 'raw': 'back of head of person at the bottom', 'sent_id': 2185, 'sent': 'back of head of person at the bottom'}, {'tokens': ['head', 'in', 'front', 'taking', 'picure'], 'raw': 'head in front taking picure', 'sent_id': 2186, 'sent': 'head in front taking picure'}, {'tokens': ['back', 'of', 'head'], 'raw': 'back of head', 'sent_id': 2187, 'sent': 'back of head'}], 'category_id': 1}, {'sent_ids': [2213, 2214, 2215], 'file_name': 'COCO_train2014_000000572960_1.jpg', 'ann_id': 505817, 'ref_id': 780, 'image_id': 572960, 'split': 'val', 'sentences': [{'tokens': ['catcher'], 'raw': 'catcher', 'sent_id': 2213, 'sent': 'catcher'}, {'tokens': ['cather'], 'raw': 'cather', 'sent_id': 2214, 'sent': 'cather'}, {'tokens': ['catcher'], 'raw': 'catcher', 'sent_id': 2215, 'sent': 'catcher'}], 'category_id': 1}, {'sent_ids': [2216, 2217, 2218], 'file_name': 'COCO_train2014_000000572960_0.jpg', 'ann_id': 497378, 'ref_id': 781, 'image_id': 572960, 'split': 'val', 'sentences': [{'tokens': ['the', 'batter'], 'raw': 'the batter', 'sent_id': 2216, 'sent': 'the batter'}, {'tokens': ['batter'], 'raw': 'BATTER', 'sent_id': 2217, 'sent': 'batter'}, {'tokens': ['batter'], 'raw': 'batter', 'sent_id': 2218, 'sent': 'batter'}], 'category_id': 1}, {'sent_ids': [2227, 2228, 2229], 'file_name': 'COCO_train2014_000000572949_5.jpg', 'ann_id': 497043, 'ref_id': 785, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['second', 'person', 'from', 'right'], 'raw': '2nd person from right', 'sent_id': 2227, 'sent': 'second person from right'}, {'tokens': ['second', 'person', 'from', 'right'], 'raw': '2nd person from right', 'sent_id': 2228, 'sent': 'second person from right'}, {'tokens': ['second', 'guy', 'from', 'right', 'white', 'shirt'], 'raw': 'second guy from right white shirt', 'sent_id': 2229, 'sent': 'second guy from right white shirt'}], 'category_id': 1}, {'sent_ids': [2230, 2231, 2232], 'file_name': 'COCO_train2014_000000572949_4.jpg', 'ann_id': 426784, 'ref_id': 786, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['man', 'on', 'right'], 'raw': 'man on right', 'sent_id': 2230, 'sent': 'man on right'}, {'tokens': ['guy', 'iwth', 'glasses', 'on', 'right'], 'raw': 'guy iwth glasses on right', 'sent_id': 2231, 'sent': 'guy iwth glasses on right'}, {'tokens': ['man', 'on', 'the', 'far', 'right'], 'raw': 'man on the far right', 'sent_id': 2232, 'sent': 'man on the far right'}], 'category_id': 1}, {'sent_ids': [2233, 2234, 2235], 'file_name': 'COCO_train2014_000000572949_3.jpg', 'ann_id': 114430, 'ref_id': 787, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['swirly', 'rug', 'on', 'floor', 'at', 'bottom', 'right', 'area'], 'raw': 'swirly rug on floor at bottom right area', 'sent_id': 2233, 'sent': 'swirly rug on floor at bottom right area'}, {'tokens': ['swirly', 'couch', 'front', 'right', 'side'], 'raw': 'swirly couch front right side', 'sent_id': 2234, 'sent': 'swirly couch front right side'}, {'tokens': ['the', 'paisley', 'right', 'bottom', 'corner'], 'raw': 'the paisley right bottom corner', 'sent_id': 2235, 'sent': 'the paisley right bottom corner'}], 'category_id': 63}, {'sent_ids': [2236, 2237, 2238], 'file_name': 'COCO_train2014_000000572949_23.jpg', 'ann_id': 2160383, 'ref_id': 788, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['man', 'in', 'jersey'], 'raw': 'man in jersey', 'sent_id': 2236, 'sent': 'man in jersey'}, {'tokens': ['guy', 'in', 'back', 'with', 'arm', 'on', 'chair'], 'raw': 'guy in back with arm on chair', 'sent_id': 2237, 'sent': 'guy in back with arm on chair'}, {'tokens': ['guy', 'back', 'navy', '07'], 'raw': 'guy back navy 07', 'sent_id': 2238, 'sent': 'guy back navy 07'}], 'category_id': 1}, {'sent_ids': [2239, 2240, 2241], 'file_name': 'COCO_train2014_000000572949_21.jpg', 'ann_id': 1946115, 'ref_id': 789, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'right', 'swirl'], 'raw': 'BOTTOM RIGHT SWIRL', 'sent_id': 2239, 'sent': 'bottom right swirl'}, {'tokens': ['partial', 'chair', 'front', 'bottom'], 'raw': 'partial chair front bottom', 'sent_id': 2240, 'sent': 'partial chair front bottom'}, {'tokens': ['chair', 'on', 'far', 'right', 'in', 'foreground'], 'raw': 'Chair on far right in foreground', 'sent_id': 2241, 'sent': 'chair on far right in foreground'}], 'category_id': 62}, {'sent_ids': [2242, 2243, 2244], 'file_name': 'COCO_train2014_000000572949_20.jpg', 'ann_id': 1940800, 'ref_id': 790, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'left', 'portion', 'of', 'couch', 'on', 'left'], 'raw': 'bottom left portion of couch on left', 'sent_id': 2242, 'sent': 'bottom left portion of couch on left'}, {'tokens': ['chair', 'on', 'front', 'left'], 'raw': 'chair on front left', 'sent_id': 2243, 'sent': 'chair on front left'}, {'tokens': ['chair', 'on', 'left'], 'raw': 'chair on left', 'sent_id': 2244, 'sent': 'chair on left'}], 'category_id': 62}, {'sent_ids': [2245, 2246, 2247], 'file_name': 'COCO_train2014_000000572949_2.jpg', 'ann_id': 99436, 'ref_id': 791, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['chair', 'left', 'most'], 'raw': 'chair left most', 'sent_id': 2245, 'sent': 'chair left most'}, {'tokens': ['couch', 'with', 'squares'], 'raw': 'couch with squares', 'sent_id': 2246, 'sent': 'couch with squares'}, {'tokens': ['left', 'couch'], 'raw': 'left couch', 'sent_id': 2247, 'sent': 'left couch'}], 'category_id': 63}, {'sent_ids': [2248, 2249, 2250], 'file_name': 'COCO_train2014_000000572949_18.jpg', 'ann_id': 1709303, 'ref_id': 792, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['far', 'left', 'guy'], 'raw': 'far left guy', 'sent_id': 2248, 'sent': 'far left guy'}, {'tokens': ['man', 'on', 'left'], 'raw': 'man on left', 'sent_id': 2249, 'sent': 'man on left'}, {'tokens': ['left', 'person'], 'raw': 'Left person', 'sent_id': 2250, 'sent': 'left person'}], 'category_id': 1}, {'sent_ids': [2251, 2252], 'file_name': 'COCO_train2014_000000572949_14.jpg', 'ann_id': 1595524, 'ref_id': 793, 'image_id': 572949, 'split': 'val', 'sentences': [{'tokens': ['chair', 'under', 'the', 'guy', 'on', 'the', 'right'], 'raw': 'chair under the guy on the right', 'sent_id': 2251, 'sent': 'chair under the guy on the right'}, {'tokens': ['chair', 'on', 'right', 'next', 'to', 'man', 'in', 'blue', 'shirt'], 'raw': 'chair on right next to man in blue shirt', 'sent_id': 2252, 'sent': 'chair on right next to man in blue shirt'}], 'category_id': 62}, {'sent_ids': [2629, 2630, 2631], 'file_name': 'COCO_train2014_000000571671_1.jpg', 'ann_id': 52610, 'ref_id': 927, 'image_id': 571671, 'split': 'val', 'sentences': [{'tokens': ['taleft', 'cat'], 'raw': 'taleft cat', 'sent_id': 2629, 'sent': 'taleft cat'}, {'tokens': ['black', 'cat', 'on', 'left'], 'raw': 'black cat on Left', 'sent_id': 2630, 'sent': 'black cat on left'}, {'tokens': ['black', 'cat'], 'raw': 'black cat', 'sent_id': 2631, 'sent': 'black cat'}], 'category_id': 17}, {'sent_ids': [2632, 2633, 2634], 'file_name': 'COCO_train2014_000000571671_0.jpg', 'ann_id': 48543, 'ref_id': 928, 'image_id': 571671, 'split': 'val', 'sentences': [{'tokens': ['brown', 'cat'], 'raw': 'brown cat', 'sent_id': 2632, 'sent': 'brown cat'}, {'tokens': ['cat', 'upside', 'down'], 'raw': 'cat upside down', 'sent_id': 2633, 'sent': 'cat upside down'}, {'tokens': ['cat', 'on', 'chair'], 'raw': 'cat on chair', 'sent_id': 2634, 'sent': 'cat on chair'}], 'category_id': 17}, {'sent_ids': [2720, 2721, 2722], 'file_name': 'COCO_train2014_000000571541_3.jpg', 'ann_id': 1366234, 'ref_id': 960, 'image_id': 571541, 'split': 'val', 'sentences': [{'tokens': ['yellow', 'and', 'blue', 'vehicle', 'closest', 'to', 'camera'], 'raw': 'yellow and blue vehicle closest to camera', 'sent_id': 2720, 'sent': 'yellow and blue vehicle closest to camera'}, {'tokens': ['yellow', 'and', 'blue', 'truck', 'second', 'from', 'left'], 'raw': 'yellow and blue truck second from left', 'sent_id': 2721, 'sent': 'yellow and blue truck second from left'}, {'tokens': ['blue', 'and', 'yellow', 'bus', 'first', 'one'], 'raw': 'blue and yellow bus, first one', 'sent_id': 2722, 'sent': 'blue and yellow bus first one'}], 'category_id': 6}, {'sent_ids': [2723, 2724, 2725], 'file_name': 'COCO_train2014_000000571541_2.jpg', 'ann_id': 1366141, 'ref_id': 961, 'image_id': 571541, 'split': 'val', 'sentences': [{'tokens': ['red', 'turck', 'close', 'to', 'us'], 'raw': 'red turck close to us', 'sent_id': 2723, 'sent': 'red turck close to us'}, {'tokens': ['red', 'bus'], 'raw': 'red bus', 'sent_id': 2724, 'sent': 'red bus'}, {'tokens': ['frontmost', 'vehicle'], 'raw': 'frontmost vehicle', 'sent_id': 2725, 'sent': 'frontmost vehicle'}], 'category_id': 6}, {'sent_ids': [2726, 2727, 2728], 'file_name': 'COCO_train2014_000000571541_1.jpg', 'ann_id': 1365791, 'ref_id': 962, 'image_id': 571541, 'split': 'val', 'sentences': [{'tokens': ['white', 'vehicle', 'third', 'one', 'from', 'us'], 'raw': 'white vehicle, 3rd one from us', 'sent_id': 2726, 'sent': 'white vehicle third one from us'}, {'tokens': ['all', 'white', 'bus'], 'raw': 'all white bus', 'sent_id': 2727, 'sent': 'all white bus'}, {'tokens': ['third', 'bus', 'frm', 'left'], 'raw': '3rd bus frm left', 'sent_id': 2728, 'sent': 'third bus frm left'}], 'category_id': 6}, {'sent_ids': [2952, 2953, 2954], 'file_name': 'COCO_train2014_000000570440_4.jpg', 'ann_id': 1710301, 'ref_id': 1040, 'image_id': 570440, 'split': 'val', 'sentences': [{'tokens': ['pitcher'], 'raw': 'Pitcher', 'sent_id': 2952, 'sent': 'pitcher'}, {'tokens': ['that', 'was', 'it', 'man', 'in', 'the', 'center', 'up', 'front'], 'raw': 'that was it.... man in the center up front', 'sent_id': 2953, 'sent': 'that was it man in the center up front'}, {'tokens': ['man', 'front'], 'raw': 'man front', 'sent_id': 2954, 'sent': 'man front'}], 'category_id': 1}, {'sent_ids': [2955, 2956, 2957], 'file_name': 'COCO_train2014_000000570440_1.jpg', 'ann_id': 531423, 'ref_id': 1041, 'image_id': 570440, 'split': 'val', 'sentences': [{'tokens': ['guy', 'in', 'back'], 'raw': 'guy in back', 'sent_id': 2955, 'sent': 'guy in back'}, {'tokens': ['back', 'guy'], 'raw': 'back guy', 'sent_id': 2956, 'sent': 'back guy'}, {'tokens': ['back', 'player'], 'raw': 'back player', 'sent_id': 2957, 'sent': 'back player'}], 'category_id': 1}, {'sent_ids': [2999, 3000, 3001], 'file_name': 'COCO_train2014_000000570178_2.jpg', 'ann_id': 1059389, 'ref_id': 1056, 'image_id': 570178, 'split': 'val', 'sentences': [{'tokens': ['brocvoli', 'right', 'back'], 'raw': 'brocvoli right back', 'sent_id': 2999, 'sent': 'brocvoli right back'}, {'tokens': ['bigger', 'broccoli'], 'raw': 'bigger broccoli', 'sent_id': 3000, 'sent': 'bigger broccoli'}, {'tokens': ['top', 'piece', 'of', 'broccoli'], 'raw': 'top piece of broccoli', 'sent_id': 3001, 'sent': 'top piece of broccoli'}], 'category_id': 56}, {'sent_ids': [3002, 3003, 3004], 'file_name': 'COCO_train2014_000000570178_1.jpg', 'ann_id': 1056621, 'ref_id': 1057, 'image_id': 570178, 'split': 'val', 'sentences': [{'tokens': ['bottom', 'broccoli'], 'raw': 'bottom broccoli', 'sent_id': 3002, 'sent': 'bottom broccoli'}, {'tokens': ['yucky', 'broccoli', 'front', 'most', 'piece'], 'raw': 'yucky broccoli front most piece', 'sent_id': 3003, 'sent': 'yucky broccoli front most piece'}, {'tokens': ['brocolli', 'bottom'], 'raw': 'brocolli bottom', 'sent_id': 3004, 'sent': 'brocolli bottom'}], 'category_id': 56}, {'sent_ids': [3154, 3155, 3156], 'file_name': 'COCO_train2014_000000569613_1.jpg', 'ann_id': 582574, 'ref_id': 1109, 'image_id': 569613, 'split': 'val', 'sentences': [{'tokens': ['elephant', 'right'], 'raw': 'elephant right', 'sent_id': 3154, 'sent': 'elephant right'}, {'tokens': ['right', 'elephant'], 'raw': 'right eleph', 'sent_id': 3155, 'sent': 'right elephant'}, {'tokens': ['right', 'elephant'], 'raw': 'right elephant', 'sent_id': 3156, 'sent': 'right elephant'}], 'category_id': 22}, {'sent_ids': [3157, 3158, 3159], 'file_name': 'COCO_train2014_000000569613_0.jpg', 'ann_id': 581925, 'ref_id': 1110, 'image_id': 569613, 'split': 'val', 'sentences': [{'tokens': ['elephant', 'left'], 'raw': 'ele left', 'sent_id': 3157, 'sent': 'elephant left'}, {'tokens': ['left'], 'raw': 'left', 'sent_id': 3158, 'sent': 'left'}, {'tokens': ['left', 'elephant'], 'raw': 'left ele', 'sent_id': 3159, 'sent': 'left elephant'}], 'category_id': 22}, {'sent_ids': [3347, 3348, 3349], 'file_name': 'COCO_train2014_000000568873_4.jpg', 'ann_id': 545096, 'ref_id': 1175, 'image_id': 568873, 'split': 'val', 'sentences': [{'tokens': ['guy', 'far', 'right'], 'raw': 'guy far right', 'sent_id': 3347, 'sent': 'guy far right'}, {'tokens': ['dude', 'whos', 'way', 'too', 'cool', 'to', 'wear', 'a', 'purple', 'tshirt'], 'raw': "dude who's way too cool to wear a purple t-shirt", 'sent_id': 3348, 'sent': 'dude whos way too cool to wear a purple tshirt'}, {'tokens': ['man', 'not', 'in', 'purple'], 'raw': 'man not in purple', 'sent_id': 3349, 'sent': 'man not in purple'}], 'category_id': 1}, {'sent_ids': [3350, 3351, 3352], 'file_name': 'COCO_train2014_000000568873_3.jpg', 'ann_id': 536768, 'ref_id': 1176, 'image_id': 568873, 'split': 'val', 'sentences': [{'tokens': ['second', 'from', 'the', 'right'], 'raw': 'SECOND FROM THE RIGHT', 'sent_id': 3350, 'sent': 'second from the right'}, {'tokens': ['kid', 'in', 'purple', 'shirt', 'furthest', 'right', 'of', 'the', 'four'], 'raw': 'kid in purple shirt furthest right of the four', 'sent_id': 3351, 'sent': 'kid in purple shirt furthest right of the four'}, {'tokens': ['boy', 'in', 'purple', 'wearing', 'dark', 'glasses'], 'raw': 'boy in purple wearing dark glasses', 'sent_id': 3352, 'sent': 'boy in purple wearing dark glasses'}], 'category_id': 1}, {'sent_ids': [3353, 3354, 3355], 'file_name': 'COCO_train2014_000000568873_2.jpg', 'ann_id': 528289, 'ref_id': 1177, 'image_id': 568873, 'split': 'val', 'sentences': [{'tokens': ['center', 'man', 'with', 'black', 'hair', 'back', 'to', 'us'], 'raw': 'center man with black hair, back to us', 'sent_id': 3353, 'sent': 'center man with black hair back to us'}, {'tokens': ['black', 'shorts', 'in', 'middle'], 'raw': 'black shorts in middle', 'sent_id': 3354, 'sent': 'black shorts in middle'}, {'tokens': ['center', 'dude'], 'raw': 'center dude', 'sent_id': 3355, 'sent': 'center dude'}], 'category_id': 1}, {'sent_ids': [3356, 3357, 3358], 'file_name': 'COCO_train2014_000000568873_1.jpg', 'ann_id': 518232, 'ref_id': 1178, 'image_id': 568873, 'split': 'val', 'sentences': [{'tokens': ['boy', 'sitting', 'on', 'the', 'bench', 'closest', 'to', 'us'], 'raw': 'boy sitting on the bench closest to us.', 'sent_id': 3356, 'sent': 'boy sitting on the bench closest to us'}, {'tokens': ['boy', 'sitting', 'in', 'front'], 'raw': 'boy sitting in front', 'sent_id': 3357, 'sent': 'boy sitting in front'}, {'tokens': ['guy', 'sitting'], 'raw': 'guy sitting', 'sent_id': 3358, 'sent': 'guy sitting'}], 'category_id': 1}, {'sent_ids': [3431, 3432, 3433], 'file_name': 'COCO_train2014_000000568654_1.jpg', 'ann_id': 71254, 'ref_id': 1203, 'image_id': 568654, 'split': 'val', 'sentences': [{'tokens': ['mother', 'cow'], 'raw': 'mother cow', 'sent_id': 3431, 'sent': 'mother cow'}, {'tokens': ['large', 'cow'], 'raw': 'large cow', 'sent_id': 3432, 'sent': 'large cow'}, {'tokens': ['big', 'cow'], 'raw': 'big cow', 'sent_id': 3433, 'sent': 'big cow'}], 'category_id': 21}, {'sent_ids': [3434, 3435, 3436], 'file_name': 'COCO_train2014_000000568654_0.jpg', 'ann_id': 71111, 'ref_id': 1204, 'image_id': 568654, 'split': 'val', 'sentences': [{'tokens': ['calf'], 'raw': 'calf', 'sent_id': 3434, 'sent': 'calf'}, {'tokens': ['baby', 'cow'], 'raw': 'baby cow', 'sent_id': 3435, 'sent': 'baby cow'}, {'tokens': ['small', 'cow'], 'raw': 'small cow', 'sent_id': 3436, 'sent': 'small cow'}], 'category_id': 21}, {'sent_ids': [3520, 3521, 3522], 'file_name': 'COCO_train2014_000000568272_1.jpg', 'ann_id': 1822289, 'ref_id': 1233, 'image_id': 568272, 'split': 'val', 'sentences': [{'tokens': ['ass'], 'raw': 'ASS', 'sent_id': 3520, 'sent': 'ass'}, {'tokens': ['big', 'zebra'], 'raw': 'big zebra', 'sent_id': 3521, 'sent': 'big zebra'}, {'tokens': ['bigger', 'zebra'], 'raw': 'bigger zebra', 'sent_id': 3522, 'sent': 'bigger zebra'}], 'category_id': 24}, {'sent_ids': [3523, 3524, 3525], 'file_name': 'COCO_train2014_000000568272_0.jpg', 'ann_id': 588904, 'ref_id': 1234, 'image_id': 568272, 'split': 'val', 'sentences': [{'tokens': ['small', 'zebra', 'facing'], 'raw': 'small zebra facing', 'sent_id': 3523, 'sent': 'small zebra facing'}, {'tokens': ['left', 'zbra'], 'raw': 'left zbra', 'sent_id': 3524, 'sent': 'left zbra'}, {'tokens': ['baby', 'zebra'], 'raw': 'baby zebra', 'sent_id': 3525, 'sent': 'baby zebra'}], 'category_id': 24}, {'sent_ids': [3580, 3581, 3582], 'file_name': 'COCO_train2014_000000567964_2.jpg', 'ann_id': 457754, 'ref_id': 1254, 'image_id': 567964, 'split': 'val', 'sentences': [{'tokens': ['hand'], 'raw': 'hand', 'sent_id': 3580, 'sent': 'hand'}, {'tokens': ['hand', 'holding', 'hot', 'dog'], 'raw': 'hand holding hot dog', 'sent_id': 3581, 'sent': 'hand holding hot dog'}, {'tokens': ['hand', 'holding', 'hot', 'dog'], 'raw': 'hand holding hot dog', 'sent_id': 3582, 'sent': 'hand holding hot dog'}], 'category_id': 1}, {'sent_ids': [3583, 3584, 3585], 'file_name': 'COCO_train2014_000000567964_1.jpg', 'ann_id': 455753, 'ref_id': 1255, 'image_id': 567964, 'split': 'val', 'sentences': [{'tokens': ['white', 'shirt'], 'raw': 'white shirt', 'sent_id': 3583, 'sent': 'white shirt'}, {'tokens': ['mans', 'body', 'above', 'hot', 'dog'], 'raw': 'mans body above hot dog', 'sent_id': 3584, 'sent': 'mans body above hot dog'}, {'tokens': ['person', 'in', 'back', 'in', 'white'], 'raw': 'person in back in white', 'sent_id': 3585, 'sent': 'person in back in white'}], 'category_id': 1}, {'sent_ids': [3722, 3723, 3724], 'file_name': 'COCO_train2014_000000567199_3.jpg', 'ann_id': 1269359, 'ref_id': 1304, 'image_id': 567199, 'split': 'val', 'sentences': [{'tokens': ['bitch', 'kid'], 'raw': 'bitch kid', 'sent_id': 3722, 'sent': 'bitch kid'}, {'tokens': ['little', 'kid', 'in', 'snow', 'and', 'in', 'the', 'front'], 'raw': 'little kid in snow and in the front', 'sent_id': 3723, 'sent': 'little kid in snow and in the front'}, {'tokens': ['little', 'kid'], 'raw': 'little kid', 'sent_id': 3724, 'sent': 'little kid'}], 'category_id': 1}, {'sent_ids': [3725, 3726, 3727], 'file_name': 'COCO_train2014_000000567199_1.jpg', 'ann_id': 1242292, 'ref_id': 1305, 'image_id': 567199, 'split': 'val', 'sentences': [{'tokens': ['red', 'shirt'], 'raw': 'red shirt', 'sent_id': 3725, 'sent': 'red shirt'}, {'tokens': ['red', 'jacketdad'], 'raw': 'red jacket-dad', 'sent_id': 3726, 'sent': 'red jacketdad'}, {'tokens': ['red'], 'raw': 'Red', 'sent_id': 3727, 'sent': 'red'}], 'category_id': 1}, {'sent_ids': [3728, 3729, 3730], 'file_name': 'COCO_train2014_000000567189_1.jpg', 'ann_id': 1187527, 'ref_id': 1306, 'image_id': 567189, 'split': 'val', 'sentences': [{'tokens': ['left', 'bag'], 'raw': 'left bag', 'sent_id': 3728, 'sent': 'left bag'}, {'tokens': ['luggage', 'left', 'side'], 'raw': 'luggage left side', 'sent_id': 3729, 'sent': 'luggage left side'}, {'tokens': ['bag', 'on', 'left'], 'raw': 'bag on left', 'sent_id': 3730, 'sent': 'bag on left'}], 'category_id': 33}, {'sent_ids': [3731, 3732, 3733], 'file_name': 'COCO_train2014_000000567189_0.jpg', 'ann_id': 1187071, 'ref_id': 1307, 'image_id': 567189, 'split': 'val', 'sentences': [{'tokens': ['large', 'bag'], 'raw': 'large bag', 'sent_id': 3731, 'sent': 'large bag'}, {'tokens': ['big', 'one'], 'raw': 'big one', 'sent_id': 3732, 'sent': 'big one'}, {'tokens': ['tall', 'suitcase'], 'raw': 'tall suitcase', 'sent_id': 3733, 'sent': 'tall suitcase'}], 'category_id': 33}, {'sent_ids': [3853, 3854, 3855], 'file_name': 'COCO_train2014_000000566798_24.jpg', 'ann_id': 2154286, 'ref_id': 1350, 'image_id': 566798, 'split': 'val', 'sentences': [{'tokens': ['man', 'on', 'left'], 'raw': 'man on left', 'sent_id': 3853, 'sent': 'man on left'}, {'tokens': ['man'], 'raw': 'man', 'sent_id': 3854, 'sent': 'man'}, {'tokens': ['man', 'on', 'left'], 'raw': 'man on left', 'sent_id': 3855, 'sent': 'man on left'}], 'category_id': 1}, {'sent_ids': [3856, 3857, 3858], 'file_name': 'COCO_train2014_000000566798_2.jpg', 'ann_id': 560745, 'ref_id': 1351, 'image_id': 566798, 'split': 'val', 'sentences': [{'tokens': ['girl'], 'raw': 'girl', 'sent_id': 3856, 'sent': 'girl'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 3857, 'sent': 'woman'}, {'tokens': ['person', 'wfolded', 'arms'], 'raw': 'person w/folded arms', 'sent_id': 3858, 'sent': 'person wfolded arms'}], 'category_id': 1}, {'sent_ids': [3950, 3951, 3952], 'file_name': 'COCO_train2014_000000566395_8.jpg', 'ann_id': 1355583, 'ref_id': 1383, 'image_id': 566395, 'split': 'val', 'sentences': [{'tokens': ['car', 'next', 'to', 'cab'], 'raw': 'car next to cab', 'sent_id': 3950, 'sent': 'car next to cab'}, {'tokens': ['silver', 'car', 'on', 'left'], 'raw': 'silver car on left', 'sent_id': 3951, 'sent': 'silver car on left'}, {'tokens': ['left', 'car'], 'raw': 'left car', 'sent_id': 3952, 'sent': 'left car'}], 'category_id': 3}, {'sent_ids': [3953, 3954, 3955], 'file_name': 'COCO_train2014_000000566395_0.jpg', 'ann_id': 353550, 'ref_id': 1384, 'image_id': 566395, 'split': 'val', 'sentences': [{'tokens': ['yellow', 'cab'], 'raw': 'yellow cab', 'sent_id': 3953, 'sent': 'yellow cab'}, {'tokens': ['yellow'], 'raw': 'yellow', 'sent_id': 3954, 'sent': 'yellow'}, {'tokens': ['taxi'], 'raw': 'taxi', 'sent_id': 3955, 'sent': 'taxi'}], 'category_id': 3}, {'sent_ids': [4082, 4083, 4084], 'file_name': 'COCO_train2014_000000565884_1.jpg', 'ann_id': 584077, 'ref_id': 1428, 'image_id': 565884, 'split': 'val', 'sentences': [{'tokens': ['right', 'eleohgabt'], 'raw': 'right eleohgabt', 'sent_id': 4082, 'sent': 'right eleohgabt'}, {'tokens': ['one', 'on', 'the', 'right'], 'raw': 'one on the right', 'sent_id': 4083, 'sent': 'one on the right'}, {'tokens': ['right', 'elephant'], 'raw': 'right ele', 'sent_id': 4084, 'sent': 'right elephant'}], 'category_id': 22}, {'sent_ids': [4085, 4086, 4087], 'file_name': 'COCO_train2014_000000565884_0.jpg', 'ann_id': 581810, 'ref_id': 1429, 'image_id': 565884, 'split': 'val', 'sentences': [{'tokens': ['elephant', 'left'], 'raw': 'elephant left', 'sent_id': 4085, 'sent': 'elephant left'}, {'tokens': ['left', 'elephant'], 'raw': 'left elephant', 'sent_id': 4086, 'sent': 'left elephant'}, {'tokens': ['far', 'left', 'elephant'], 'raw': 'far left elephant', 'sent_id': 4087, 'sent': 'far left elephant'}], 'category_id': 22}, {'sent_ids': [4099, 4100, 4101], 'file_name': 'COCO_train2014_000000565769_2.jpg', 'ann_id': 585116, 'ref_id': 1434, 'image_id': 565769, 'split': 'val', 'sentences': [{'tokens': ['right', 'elephant'], 'raw': 'right elep', 'sent_id': 4099, 'sent': 'right elephant'}, {'tokens': ['elephant', 'on', 'right', 'thats', 'hidden'], 'raw': 'elephant on right thats hidden', 'sent_id': 4100, 'sent': 'elephant on right thats hidden'}, {'tokens': ['right', 'elephants', 'behind'], 'raw': "right elephant's behind", 'sent_id': 4101, 'sent': 'right elephants behind'}], 'category_id': 22}, {'sent_ids': [4102, 4103, 4104], 'file_name': 'COCO_train2014_000000565769_1.jpg', 'ann_id': 581605, 'ref_id': 1435, 'image_id': 565769, 'split': 'val', 'sentences': [{'tokens': ['dark', 'elephant', 'in', 'back'], 'raw': 'dark elephant in back', 'sent_id': 4102, 'sent': 'dark elephant in back'}, {'tokens': ['second', 'elephant', 'from', 'left'], 'raw': 'second elephant from left', 'sent_id': 4103, 'sent': 'second elephant from left'}, {'tokens': ['elephant', 'in', 'backleft'], 'raw': 'elephant in backleft', 'sent_id': 4104, 'sent': 'elephant in backleft'}], 'category_id': 22}, {'sent_ids': [4105, 4106, 4107], 'file_name': 'COCO_train2014_000000565769_0.jpg', 'ann_id': 581006, 'ref_id': 1436, 'image_id': 565769, 'split': 'val', 'sentences': [{'tokens': ['front', 'elephant', 'are', 'you', 'on', 'mtf'], 'raw': 'front elephant, are you on mtf?', 'sent_id': 4105, 'sent': 'front elephant are you on mtf'}, {'tokens': ['front', 'elephant'], 'raw': 'front elephant', 'sent_id': 4106, 'sent': 'front elephant'}, {'tokens': ['far', 'left', 'elephant'], 'raw': 'far left ele', 'sent_id': 4107, 'sent': 'far left elephant'}], 'category_id': 22}, {'sent_ids': [4174, 4175, 4176], 'file_name': 'COCO_train2014_000000565476_1.jpg', 'ann_id': 1044595, 'ref_id': 1460, 'image_id': 565476, 'split': 'val', 'sentences': [{'tokens': ['the', 'banana', 'in', 'the', 'middle', 'with', '2', 'black', 'dots', 'on', 'the', 'stem'], 'raw': 'The banana in the middle with 2 black dots on the stem', 'sent_id': 4174, 'sent': 'the banana in the middle with 2 black dots on the stem'}, {'tokens': ['middle', 'banana'], 'raw': 'middle banana', 'sent_id': 4175, 'sent': 'middle banana'}, {'tokens': ['the', 'banana', 'in', 'the', 'middle', 'at', 'the', 'top', 'of', 'the', 'image'], 'raw': 'the banana in the middle at the top of the image', 'sent_id': 4176, 'sent': 'the banana in the middle at the top of the image'}], 'category_id': 52}, {'sent_ids': [4177, 4178, 4179], 'file_name': 'COCO_train2014_000000565476_0.jpg', 'ann_id': 1043529, 'ref_id': 1461, 'image_id': 565476, 'split': 'val', 'sentences': [{'tokens': ['banana', 'leftmiddle'], 'raw': 'banana left/middle', 'sent_id': 4177, 'sent': 'banana leftmiddle'}, {'tokens': ['left', 'banana'], 'raw': 'left banana', 'sent_id': 4178, 'sent': 'left banana'}, {'tokens': ['biggest', 'banana'], 'raw': 'biggest banana', 'sent_id': 4179, 'sent': 'biggest banana'}], 'category_id': 52}, {'sent_ids': [4261, 4262, 4263], 'file_name': 'COCO_train2014_000000565243_2.jpg', 'ann_id': 510506, 'ref_id': 1492, 'image_id': 565243, 'split': 'val', 'sentences': [{'tokens': ['man'], 'raw': 'man', 'sent_id': 4261, 'sent': 'man'}, {'tokens': ['guy'], 'raw': 'guy', 'sent_id': 4262, 'sent': 'guy'}, {'tokens': ['man'], 'raw': 'MAN', 'sent_id': 4263, 'sent': 'man'}], 'category_id': 1}, {'sent_ids': [4264, 4265, 4266], 'file_name': 'COCO_train2014_000000565243_1.jpg', 'ann_id': 487758, 'ref_id': 1493, 'image_id': 565243, 'split': 'val', 'sentences': [{'tokens': ['woman'], 'raw': 'woman', 'sent_id': 4264, 'sent': 'woman'}, {'tokens': ['girl'], 'raw': 'girl', 'sent_id': 4265, 'sent': 'girl'}, {'tokens': ['woman'], 'raw': 'woman', 'sent_id': 4266, 'sent': 'woman'}], 'category_id': 1}, {'sent_ids': [4267, 4268], 'file_name': 'COCO_train2014_000000565220_1.jpg', 'ann_id': 1068936, 'ref_id': 1494, 'image_id': 565220, 'split': 'val', 'sentences': [{'tokens': ['hot', 'dog', 'on', 'top'], 'raw': 'hot dog on top', 'sent_id': 4267, 'sent': 'hot dog on top'}, {'tokens': ['top', 'dog'], 'raw': 'top dog', 'sent_id': 4268, 'sent': 'top dog'}], 'category_id': 58...
                    """
                else:
                    print('No such split [%s]' % split)
                    sys.exit()
        ref_ids = [ref['ref_id'] for ref in refs]
        """
        ref_ids shape : 3811
        ref_ids : [77, 78, 85, 86, 101, 102, 151, 177, 178, 179, 180, 198, 199, 215, 216, 276, 277, 278, 279, 280, 281, 395, 396, 397, 398, 412, 413, 465, 466, 492, 493, 571, 572, 610, 611, 633, 634, 681, 682, 683, 684, 717, 718, 745, 746, 747, 748, 768, 769, 770, 780, 781, 785, 786, 787, 788, 789, 790, 791, 792, 793, 927, 928, 960, 961, 962, 1040, 1041, 1056, 1057, 1109, 1110, 1175, 1176, 1177, 1178, 1203, 1204, 1233, 1234, 1254, 1255, 1304, 1305, 1306, 1307, 1350, 1351, 1383, 1384, 1428, 1429, 1434, 1435, 1436, 1460, 1461, 1492, 1493, 1494...
        """
        return ref_ids

    def getAnnIds(self, image_ids=[], cat_ids=[], ref_ids=[]):
        image_ids = image_ids if type(image_ids) == list else [image_ids]
        cat_ids = cat_ids if type(cat_ids) == list else [cat_ids]
        ref_ids = ref_ids if type(ref_ids) == list else [ref_ids]

        if len(image_ids) == len(cat_ids) == len(ref_ids) == 0:
            ann_ids = [ann['id'] for ann in self.data['annotations']]
        else:
            if not len(image_ids) == 0:
                lists = [self.imgToAnns[image_id] for image_id in image_ids if
                         image_id in self.imgToAnns]  # list of [anns]
                anns = list(itertools.chain.from_iterable(lists))
            else:
                anns = self.data['annotations']
            if not len(cat_ids) == 0:
                anns = [ann for ann in anns if ann['category_id'] in cat_ids]
            ann_ids = [ann['id'] for ann in anns]
            if not len(ref_ids) == 0:
                ids = set(ann_ids).intersection(set([self.Refs[ref_id]['ann_id'] for ref_id in ref_ids]))
        return ann_ids

    def getImgIds(self, ref_ids=[]):
        ref_ids = ref_ids if type(ref_ids) == list else [ref_ids]
        """
        ref_ids shape : 3811
        ref_ids : [77, 78, 85, 86, 101, 102, 151, 177, 178, 179, 180, 198, 199, 215, 216, 276, 277, 278, 279, 280, 281, 395, 396, 397, 398, 412, 413, 465, 466, 492, 493, 571, 572, 610, 611, 633, 634, 681, 682, 683, 684, 717, 718, 745, 746, 747, 748, 768, 769, 770, 780, 781, 785, 786, 787, 788, 789, 790, 791, 792, 793, 927, 928, 960, 961, 962, 1040, 1041, 1056, 1057, 1109, 1110, 1175, 1176, 1177, 1178, 1203, 1204, 1233, 1234, 1254, 1255, 1304, 1305, 1306, 1307, 1350, 1351, 1383, 1384, 1428, 1429, 1434, 1435, 1436, 1460, 1461, 1492, 1493, 1494...
        """

        if not len(ref_ids) == 0:
            image_ids = list(set([self.Refs[ref_id]['image_id'] for ref_id in ref_ids]))
            """
            image_ids shape : 1500
            image_ids : [376848, 278549, 532505, 434201, 401439, 270369, 122916, 41005, 507952, 409653, 319543, 352312, 270391, 139324, 548935, 458827, 16465, 442461, 139359, 114786, 24674, 532595, 114807, 270460, 98447, 409754, 376988, 319644, 106652, 49309, 327843, 82083, 516263, 442542, 450735, 573632, 245953, 344259, 467145, 57551, 491739, 254176, 409825, 393442, 565476, 508140, 8436, 344319, 303370, 205069, 360719, 73999, 344338, 483611, 327970, 196899, 147753, 65842, 188727, 336185, 327998, 549184, 246084, 98631, 90444, 180559, 106832, 98641, 377174, 57689, 57699, 24939, 385401, 369019, 295294, 147838, 516481, 442771, 278931, 393629, 524710, 16814, 573875, 238007, 205250, 74183, 197068, 139728, 557527, 156125, 385505, 549347, 123366, 426478, 66034, 139763, 549366, 238070, 311808, 107009...
            """
        else:
            image_ids = self.Imgs.keys()
        return image_ids

    def getCatIds(self):
        return self.Cats.keys()

    def loadRefs(self, ref_ids=[]):
        if type(ref_ids) == list:
            return [self.Refs[ref_id] for ref_id in ref_ids]
        elif type(ref_ids) == int:
            return [self.Refs[ref_ids]]

    def loadAnns(self, ann_ids=[]):
        if type(ann_ids) == list:
            return [self.Anns[ann_id] for ann_id in ann_ids]
        elif type(ann_ids) == int or type(ann_ids) == unicode:
            return [self.Anns[ann_ids]]

    def loadImgs(self, image_ids=[]):
        if type(image_ids) == list:
            return [self.Imgs[image_id] for image_id in image_ids]
        elif type(image_ids) == int:
            return [self.Imgs[image_ids]]

    def loadCats(self, cat_ids=[]):
        if type(cat_ids) == list:
            return [self.Cats[cat_id] for cat_id in cat_ids]
        elif type(cat_ids) == int:
            return [self.Cats[cat_ids]]

    def getRefBox(self, ref_id):
        ref = self.Refs[ref_id]
        ann = self.refToAnn[ref_id]
        return ann['bbox']  # [x, y, w, h]

    def showRef(self, ref, seg_box='seg'):
        ax = plt.gca()
        # show image
        image = self.Imgs[ref['image_id']]
        I = io.imread(osp.join(self.IMAGE_DIR, image['file_name']))
        ax.imshow(I)
        # show refer expression
        for sid, sent in enumerate(ref['sentences']):
            print('%s. %s' % (sid + 1, sent['sent']))
        # show segmentations
        if seg_box == 'seg':
            ann_id = ref['ann_id']
            ann = self.Anns[ann_id]
            polygons = []
            color = []
            c = 'none'
            if type(ann['segmentation'][0]) == list:
                # polygon used for refcoco*
                for seg in ann['segmentation']:
                    poly = np.array(seg).reshape((int(len(seg) / 2), 2))
                    polygons.append(Polygon(poly, True, alpha=0.4))
                    color.append(c)
                p = PatchCollection(polygons, facecolors=color, edgecolors=(1, 1, 0, 0), linewidths=3, alpha=1)
                ax.add_collection(p)  # thick yellow polygon
                p = PatchCollection(polygons, facecolors=color, edgecolors=(1, 0, 0, 0), linewidths=1, alpha=1)
                ax.add_collection(p)  # thin red polygon
            else:
                # mask used for refclef
                rle = ann['segmentation']
                m = mask.decode(rle)
                img = np.ones((m.shape[0], m.shape[1], 3))
                color_mask = np.array([2.0, 166.0, 101.0]) / 255
                for i in range(3):
                    img[:, :, i] = color_mask[i]
                ax.imshow(np.dstack((img, m * 0.5)))
        # show bounding-box
        elif seg_box == 'box':
            ann_id = ref['ann_id']
            ann = self.Anns[ann_id]
            bbox = self.getRefBox(ref['ref_id'])
            box_plot = Rectangle((bbox[0], bbox[1]), bbox[2], bbox[3], fill=False, edgecolor='green', linewidth=3)
            ax.add_patch(box_plot)

    def getMask(self, ref):
        # return mask, area and mask-center
        ann = self.refToAnn[ref['ref_id']]
        image = self.Imgs[ref['image_id']]

        if type(ann['segmentation'][0]) == list:  # polygon
            rle = mask.frPyObjects(ann['segmentation'], image['height'], image['width'])
        else:
            rle = ann['segmentation']

        m = mask.decode(rle)
        m = np.sum(m, axis=2)  # sometimes there are multiple binary map (corresponding to multiple segs)
        m = m.astype(np.uint8)  # convert to np.uint8
        # compute area
        area = sum(mask.area(rle))  # should be close to ann['area']
        return {'mask': m, 'area': area}


    def showMask(self, ref):
        M = self.getMask(ref)
        msk = M['mask']
        ax = plt.gca()
        ax.imshow(msk)


if __name__ == '__main__':
    refer = REFER('./refer/data/', dataset='refcoco', splitBy='unc')
    ref_ids = refer.getRefIds()

    ref_ids = refer.getRefIds(split='train')
    print('There are %s training referred objects.' % len(ref_ids))

    for ref_id in ref_ids:
        ref = refer.loadRefs(ref_id)[0]
        if len(ref['sentences']) < 2:
            continue
        print('The label is %s.' % refer.Cats[ref['category_id']])
        plt.figure()
        refer.showRef(ref, seg_box='seg')
        plt.show()
        plt.savefig('practice.png')
        break

